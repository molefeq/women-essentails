function errorController(n,t){n.closeDialog=function(){t.dismiss()}}function beuatyTipModalController(n,t,i,r){function f(){i.dismiss()}function e(){if(!u.frmBeautyTip.$valid){t.$broadcast("action-complete",!0);return}u.actionType=="CREATE"?u.beautyTipsFactory.add().then(function(){t.$broadcast("beuaty-tip-updated",!0);i.dismiss()}):u.actionType=="UPDATE"?u.beautyTipsFactory.update().then(function(){t.$broadcast("beuaty-tip-updated",!0);i.dismiss()}):u.actionType=="DELETE"&&u.beautyTipsFactory.deleteBeuatyTip().then(function(){t.$broadcast("beuaty-tip-updated",!0);i.dismiss()})}function o(){u.beautyTipsFactory.getSubCategories(u.beautyTipsFactory.beuatyTip.CategoryId)}var u=n;u.IsDeleteUser=u.actionType=="DELETE";u.Title=u.actionType=="DELETE"?"Delete Beuaty Tip":u.actionType=="CREATE"?"Add New Beuaty Tip":"Edit Beuaty Tip";u.cancel=f;u.save=e;u.beautyTipsFactory=r;u.categoryChange=o}function companyUserModalController(n,t,i,r){function f(){t.$broadcast("user-cancel");i.dismiss()}function e(){if(!u.frmCompanyUser.$valid){t.$broadcast("action-complete",!0);return}u.actionType=="CREATE"&&r.addUser().then(function(){t.$broadcast("user-updated");i.dismiss()});u.actionType=="UPDATE"&&r.updateUser().then(function(){t.$broadcast("user-updated");i.dismiss()});u.actionType=="DELETE"&&r.deleteUser().then(function(){t.$broadcast("user-updated");i.dismiss()})}var u=n;u.IsDeleteUser=u.actionType=="DELETE";u.IsNew=u.actionType=="CREATE";u.Title=u.IsNew?"Add New User":u.IsDeleteUser?"Delete User":"Edit User";u.save=e;u.cancel=f;u.companyUsersFactory=r}function organisationModalController(n,t,i,r){function f(){i.dismiss()}function e(t){var i=!1;if(n.imageuploading=!0,!t||t.length==0){n.imageuploading=!1;return}if(angular.forEach(t,function(n){if(n.type.indexOf("image")<0){i=!0;return}}),i){alert("Only image files can be uploaded for an organisation logo");n.imageuploading=!1;return}r.uploadOrganisationImage(t[0]).then(function(){n.imageuploading=!1})}function o(){if(!u.frmOrganisation.$valid){t.$broadcast("action-complete",!0);return}u.actionType=="CREATE"&&r.add().then(function(){i.close()})}function s(){u.postalSameAsPhysicalAddress&&(u.organisationsFactory.organisation.PostalAddressLine1=u.organisationsFactory.organisation.PhysicalAddressLine1,u.organisationsFactory.organisation.PostalAddressLine2=u.organisationsFactory.organisation.PhysicalAddressLine2,u.organisationsFactory.organisation.PostalAddressSuburb=u.organisationsFactory.organisation.PhysicalAddressSuburb,u.organisationsFactory.organisation.PostalAddressCity=u.organisationsFactory.organisation.PhysicalAddressCity,u.organisationsFactory.organisation.PostalAddressPostalCode=u.organisationsFactory.organisation.PhysicalAddressPostalCode)}var u=n;u.Title=u.actionType=="CREATE"?"Add New Organisation":"Edit Organisation";u.save=o;u.cancel=f;u.uploadImage=e;u.organisationsFactory=r;u.setPostalSameAsPhysicalAddress=s;u.postalSameAsPhysicalAddress=!1}function organisationUserModalController(n,t,i,r){function f(){t.$broadcast("user-cancel");i.dismiss()}function e(){if(!u.frmOrganisationUser.$valid){t.$broadcast("action-complete",!0);return}u.actionType=="CREATE"&&r.addUser(u.model).then(function(){t.$broadcast("user-updated");i.dismiss()});u.actionType=="UPDATE"&&r.updateUser(u.model).then(function(){t.$broadcast("user-updated");i.dismiss()})}function o(){r.deleteUser(u.model).then(function(){t.$broadcast("user-updated");i.dismiss()})}var u=n;u.IsDeleteUser=u.actionType=="DELETE";u.IsNew=u.actionType=="CREATE";u.Title=u.IsNew?"Add New User":u.IsDeleteUser?"Delete User":"Edit User";u.save=e;u.deleteUser=o;u.cancel=f}function productModalController(n,t,i,r){function f(){i.dismiss()}function e(t){var i=!1;if(u.imageuploading=!0,!t||t.length==0){u.imageuploading=!1;return}if(angular.forEach(t,function(n){if(n.type.indexOf("image")<0){i=!0;return}}),i){alert("Only image files can be uploaded for an company logo");n.imageuploading=!1;return}u.productsFactory.uploadLogo(t[0]).then(function(){u.imageuploading=!1})}function o(){if(!u.frmProduct.$valid){t.$broadcast("action-complete",!0);return}u.actionType=="CREATE"?u.productsFactory.add().then(function(){t.$broadcast("product-updated",!0);i.dismiss()}):u.actionType=="UPDATE"?u.productsFactory.update().then(function(){t.$broadcast("product-updated",!0);i.dismiss()}):u.actionType=="DELETE"&&u.productsFactory.deleteProduct().then(function(){t.$broadcast("product-updated",!0);i.dismiss()})}function s(){u.productsFactory.getSubCategories(u.productsFactory.product.CategoryId)}var u=n;u.IsDeleteUser=u.actionType=="DELETE";u.Title=u.actionType=="DELETE"?"Delete Product":u.actionType=="CREATE"?"Add New Product":"Edit Product";u.cancel=f;u.save=o;u.uploadImage=e;u.productsFactory=r;u.categoryChange=s}function promotionProductModalController(n,t,i,r){function f(){i.dismiss()}function e(t){var i=!1;if(u.imageuploading=!0,!t||t.length==0){u.imageuploading=!1;return}if(angular.forEach(t,function(n){if(n.type.indexOf("image")<0){i=!0;return}}),i){alert("Only image files can be uploaded for an company logo");n.imageuploading=!1;return}u.promotionProductsFactory.uploadLogo(t[0]).then(function(){u.imageuploading=!1})}function o(n){u.calendarStatuses={isStartDateCalendarOpened:!1,isEndDateCalendarOpened:!1};switch(n){case"StartDate":u.calendarStatuses.isStartDateCalendarOpened=!0;break;case"EndDate":u.calendarStatuses.isEndDateCalendarOpened=!0}}function s(){if(!u.frmPromotionProduct.$valid){t.$broadcast("action-complete",!0);return}u.actionType=="CREATE"?u.promotionProductsFactory.add().then(function(){t.$broadcast("promotion-product-updated",!0);i.dismiss()}):u.actionType=="UPDATE"?u.promotionProductsFactory.update().then(function(){t.$broadcast("promotion-product-updated",!0);i.dismiss()}):u.actionType=="DELETE"&&u.promotionProductsFactory.deletePromotionProduct().then(function(){t.$broadcast("promotion-product-updated",!0);i.dismiss()})}var u=n;u.IsDeletePromotion=u.actionType=="DELETE";u.Title=u.actionType=="DELETE"?"Delete Promotion":u.actionType=="CREATE"?"Add New Promotion":"Edit Promotion";u.cancel=f;u.save=s;u.uploadImage=e;u.promotionProductsFactory=r;u.openCalendar=o;u.dateOptions={dateDisabled:!1,formatYear:"yyyy",maxDate:new Date(2099,1,1),minDate:new Date(1890,1,1),startingDay:1};u.altInputFormats=["M!/d!/yyyy"];u.calendarStatuses={isStartDateCalendarOpened:!1,isEndDateCalendarOpened:!1}}function roleAdminSaveModalController(n,t,i,r){function f(){t.$broadcast("role-cancel");i.dismiss()}function e(){if(!u.frmRoleAdmin.$valid){t.$broadcast("action-complete",!0);return}u.actionType=="CREATE"&&u.rolesAdminFactory.addRole().then(function(){t.$broadcast("roles-updated");i.dismiss()});u.actionType=="UPDATE"&&u.rolesAdminFactory.updateRole().then(function(){t.$broadcast("roles-updated");i.dismiss()})}function o(){u.rolesAdminFactory.deleteRole().then(function(){t.$broadcast("roles-updated");i.dismiss()})}var u=n;u.rolesAdminFactory=r;u.IsDeleteUser=u.actionType=="DELETE";u.IsNew=u.actionType=="CREATE";u.Title=u.IsNew?"Add New Role":u.IsDeleteUser?"Delete Role":"Edit Role";u.save=e;u.deleteRole=o;u.cancel=f}function salonModalController(n,t,i,r,u,f,e){function h(){i.dismiss()}function c(t){var i=!1;if(o.imageuploading=!0,!t||t.length==0){o.imageuploading=!1;return}if(angular.forEach(t,function(n){if(n.type.indexOf("image")<0){i=!0;return}}),i){alert("Only image files can be uploaded for an company logo");n.imageuploading=!1;return}o.salonsFactory.uploadLogo(t).then(function(){o.imageuploading=!1})}function c(t){var i=!1;if(o.imageuploading=!0,!t||t.length==0){o.imageuploading=!1;return}if(angular.forEach(t,function(n){if(n.type.indexOf("image")<0){i=!0;return}}),i){alert("Only image files can be uploaded for an company logo");n.imageuploading=!1;return}o.salonsFactory.uploadSalonLogo(t).then(function(){o.imageuploading=!1})}function l(t){if(o.salonsFactory.salon.Galleries&&o.salonsFactory.salon.Galleries.length>2){s("Error Uploading Iamges","Salon galleries are required and must not be more than 2.");n.imageuploading=!1;return}var i=o.salonsFactory.salon.Galleries?o.salonsFactory.salon.Galleries.length:0,r=!1;if(o.imageuploading=!0,!t||t.length==0){o.imageuploading=!1;return}if(angular.forEach(t,function(n){if(n.type.indexOf("image")<0){r=!0;return}}),r){s("Error Uploading Iamges","Only image files can be uploaded for an company logo");n.imageuploading=!1;return}if(i=i+t.length,i>2){s("Error Uploading Iamges","Salon galleries are required and must not be more than 2.");n.imageuploading=!1;return}o.salonsFactory.uploadSalonImage(t).then(function(){o.imageuploading=!1})}function a(){if(!o.frmSalon.$valid||!w()){t.$broadcast("action-complete",!0);return}o.actionType=="CREATE"?o.salonsFactory.add().then(function(){t.$broadcast("salon-updated",!0);i.dismiss()}):o.actionType=="UPDATE"?o.salonsFactory.update().then(function(){t.$broadcast("salon-updated",!0);i.dismiss()}):o.actionType=="DELETE"&&o.salonsFactory.deleteSalon().then(function(){t.$broadcast("salon-updated",!0);i.dismiss()})}function v(n){n&&o.salonsFactory.salon&&(o.salonsFactory.salon.PostalAddressLine1=o.salonsFactory.salon.PhysicalAddressLine1,o.salonsFactory.salon.PostalAddressLine2=o.salonsFactory.salon.PhysicalAddressLine2,o.salonsFactory.salon.PostalAddressSuburb=o.salonsFactory.salon.PhysicalAddressSuburb,o.salonsFactory.salon.PostalAddressCity=o.salonsFactory.salon.PhysicalAddressCity,o.salonsFactory.salon.PostalAddressPostalCode=o.salonsFactory.salon.PhysicalAddressPostalCode,o.salonsFactory.salon.PostalAddressLatitude=o.salonsFactory.salon.PhysicalAddressLatitude,o.salonsFactory.salon.PostalAddressLongitude=o.salonsFactory.salon.PhysicalAddressLongitude)}function y(){f.getCurrentLocation().then(function(n){o.salonsFactory.salon.PostalAddressLatitude=n.Position.latitude;o.salonsFactory.salon.PostalAddressLongitude=n.Position.longitude;o.salonsFactory.salon.PhysicalAddressLatitude=n.Position.latitude;o.salonsFactory.salon.PhysicalAddressLongitude=n.Position.longitude},b,{maximumAge:3e3,timeout:1e4,enableHighAccuracy:!0})}function p(n){var t=app.Utils.indexOf(o.salonsFactory.salon.Galleries,n,"id");t>=0&&o.salonsFactory.salon.Galleries.splice(t,1)}function w(){var n=!0,t="";return o.salonsFactory.salon.Logo&&o.salonsFactory.salon.Logo||(t="<div>Salon Logo is required.<\/div>",n=!1),(!o.salonsFactory.salon.Galleries||o.salonsFactory.salon.Galleries.length==0||o.salonsFactory.salon.Galleries.length>2)&&(t=t+"<div>Salon galleries are required and must not be more than 2.<\/div>",n=!1),n||s("Error Saving Salons",t),n}function b(){var n=t.$new();n.model={ErrorCode:408,ErrorHeader:"Error retrieving location",ErrorDetails:"Error retrieving location, please ensure that gps location is enabled."};t.$broadcast("server-error-occurred",{templateUrl:"errortemplate.html",scope:n,size:"sm"})}function s(n,i){var r=t.$new();r.model={ErrorCode:"404",ErrorHeader:n,ErrorDetails:i};t.$broadcast("server-error-occurred",{templateUrl:"errortemplate.html",scope:r,size:"sm"})}function k(){!o.frmWorkingHours.isValid(o.companyWorkingHourViewModel.companyWorkingHour)}var o=n;o.IsDeleteUser=o.actionType=="DELETE";o.Title=o.actionType=="DELETE"?"Delete Salon":o.actionType=="CREATE"?"Add New Salon":"Edit Salon";o.cancel=h;o.save=a;o.uploadImage=l;o.uploadLogo=c;o.salonsFactory=u;o.setPostalSameAsPhysicalAddress=v;o.postalSameAsPhysical=!1;o.getCurrentLocation=y;o.removeImage=p;o.saveWorkingHour=k;o.companyWorkingHourViewModel=e;o.companyWorkingHourViewModel.dayNames=angular.copy(u.dayNames)}function subCategoryModalController(n,t,i,r){function f(){i.dismiss()}function e(){if(!u.frmSubCategory.$valid){t.$broadcast("action-complete",!0);return}u.actionType=="CREATE"?u.subCategoryFactory.add().then(function(){t.$broadcast("sucategory-updated",!0);i.dismiss()}):u.actionType=="UPDATE"?u.subCategoryFactory.update().then(function(){t.$broadcast("sucategory-updated",!0);i.dismiss()}):u.actionType=="DELETE"&&u.subCategoryFactory.deleteSubCategory().then(function(){t.$broadcast("sucategory-updated",!0);i.dismiss()})}var u=n;u.IsDeleteSubCategory=u.actionType=="DELETE";u.Title=u.actionType=="DELETE"?"Delete Service":u.actionType=="CREATE"?"Add New Service":"Edit Service";u.cancel=f;u.save=e;u.subCategoryFactory=r}var app=app||{},menus,anonymousStates;(function(n){var i=function(){},t=5;n.Columns=[];n.SubColumns=[];n.IsHierachyGrd=!1;n.Paging={IsFirstPage:!1,IsLastPage:!1,TotalPages:0,Pages:[],PageIndex:0,PageSize:10,CurrentItemsCount:10};n.PageSizes=[];n.DataSource={};n.SubItemsField="";n.ExpandMode="Collapse";n.DisplayItemExpand=function(t){return t[n.SubItemsField]&&t[n.SubItemsField].length};n.ExpandIconClass=function(){return n.ExpandMode.toLowerCase()=="expand"?"opened":"closed"};n.ExpandRowClass=function(){return n.ExpandMode.toLowerCase()=="expand"?"expandRow":"closeRow"};n.SetPage=function(t,i){t&&t.preventDefault();n.Paging.PageIndex=i;n.Read()};n.Read=function(t){var r=n.Paging.PageSize,u=n.Paging.PageSize*(n.Paging.PageIndex-1);window.scrollTo(0,0);t&&(i=t);i({take:r,skip:u})};n.PageSizeChange=function(){n.Paging.PageIndex=1;n.Read()};n.isNormalColumn=function(n){return!n.Filter&&!n.TemplateId};n.isFormatColumn=function(n){return n.Filter&&n.Filter.Format&&!n.TemplateId};n.isTemplateColumn=function(n){return n.TemplateId};n.isNormalHeader=function(n){return!n.HeaderTemplateId};n.isTemplateHeader=function(n){return n.HeaderTemplateId};n.setOptions=function(t){t.PageSizes&&(n.PageSizes=t.PageSizes);t.Columns&&(n.Columns=t.Columns);t.SubColumns&&(n.SubColumns=t.SubColumns);t.Paging&&(n.Paging=t.Paging);t.Read&&(i=t.Read);t.SubItemsField&&(n.SubItemsField=t.SubItemsField);t.ExpandMode&&(n.ExpandMode=t.ExpandMode);t.IsHierachyGrd&&(n.IsHierachyGrd=t.IsHierachyGrd)};n.SetDataSource=function(t,i){n.DataSource={Data:t,Total:i};n.SetPages(i)};n.SetPages=function(i){var f;n.Paging.IsLastPage=!1;n.Paging.Pages=[];n.Paging.TotalPages=Math.ceil(i/n.Paging.PageSize);var e=Math.floor(n.Paging.PageIndex/t),u=e==0?1:e*t,r=e==0?t:u+(t-1),o=n.Paging.PageIndex*n.Paging.PageSize;for(r>=n.Paging.TotalPages&&(r=n.Paging.TotalPages,u=u==1||r-t<1?1:r-t),f=u;f<=r;f++)n.Paging.Pages.push(f);n.Paging.IsFirstPage=n.Paging.PageIndex===1;n.Paging.IsLastPage=n.Paging.PageIndex===n.Paging.TotalPages||n.Paging.TotalPages==0;n.Paging.CurrentItemsCount=o>=i?i:o}})(app.CustomGrid={});app=app||{};app.SubFormValidator=function(){function s(){var u=$(t).find("[name]"),i,r;for(n={},i=0;i<u.length;i++){n[$(u[i]).attr("name")]={error:!1};for(r in o)$(u[i]).attr("sub-form-"+r)&&(n[$(u[i]).attr("name")][r]={error:!1,message:$(u[i]).attr("sub-form-"+r+"-msg")},r=="pattern"&&(n[$(u[i]).attr("name")][r].pattern=$(u[i]).attr("sub-form-"+r)),r=="minlength"&&(n[$(u[i]).attr("name")][r].minlength=$(u[i]).attr("sub-form-"+r)),r=="maxlength"&&(n[$(u[i]).attr("name")][r].maxlength=$(u[i]).attr("sub-form-"+r)))}}function f(n,t,i){var u=$(n).find("div[data-for="+t+"]"),f=$(u).parent();if(!i){r(u,"k-valid-msg","k-invalid-msg");r(f,null,"haserror");return}r(u,"k-invalid-msg","k-valid-msg");r(f,"haserror",null);$(u).text(i)}function r(n,t,i){$(n)&&$(n).length>0&&$(n).hasClass(i)&&i&&$(n).removeClass(i);$(n)&&$(n).length>0&&!$(n).hasClass(t)&&t&&$(n).addClass(t)}var u=this,i=!0,n={},t=null,e=null,o={required:{},maxlength:{},pattern:{}};u.initialise=function(n,i){t=n;e=i;s()};u.isValid=function(r){var e,o,s,h;u.clearValidationMessages();for(e in n)if(e!="IsValid"){if(o=e.split("_").length==1?e:e.split("_")[e.split("_").length-1],n[e].required&&!r[o]&&!n[e].error){n[e].error=!0;i=!1;f(t,e,n[e].required.message);continue}if(n[e].maxlength&&r[o]&&r[o].length>n[e].maxlength&&!n[e].error){n[e].error=!0;i=!1;f(t,e,n[e].maxlength.message);continue}if(n[e].minlength&&r[o]&&r[o].length<n[e].minlength&&!n[e].error){n[e].error=!0;i=!1;f(t,e,n[e].minlength.message);continue}n[e].pattern&&r[o]&&(s=n[e].pattern.pattern.substring(1,n[e].pattern.pattern.length-1),h=new RegExp(s),h.test(r[o])||n[e].error||(n[e].error=!0,i=!1,f(t,e,n[e].pattern.message)))}return i};u.clearValidationMessages=function(){var u,f;i=!0;for(u in n)u!="IsValid"&&(n[u].error=!1,f=$(t).find("div[data-for="+u+"]"),r(f,"k-valid-msg","k-invalid-msg"),r(f.parent(),null,"haserror"),f.text(""))}};app=app||{},function(n){function s(n,t){var r=$(t).siblings('div[data-for="'+$(t).attr("name")+'"]').first(),u,i;if(!n||!n.$invalid){f(r,null,$(t).parent());return}for(u in n.$error)i=$(t).attr("data-"+u+"-msg"),i&&f(r,i,$(t).parent())}function f(n,t,r){if(!t){i(n,"k-valid-msg","k-invalid-msg");i(r,null,"haserror");return}i(n,"k-invalid-msg","k-valid-msg");i(r,"haserror",null);$(n).text(t)}function i(n,t,i){$(n)&&$(n).length>0&&$(n).hasClass(i)&&i&&$(n).removeClass(i);$(n)&&$(n).length>0&&!$(n).hasClass(t)&&t&&$(n).addClass(t)}function h(n){var t=u[r];$(n.Element).find("[data-for]").each(function(i,r){var o=$(r).attr("data-for"),e,h;t[n.Name][o].$setValidity("custom",!0);var u=Object.keys(t[n.Name][o].$error),s=$(r).parent(),c=s.find("[name="+o+"]")[0];if(u&&u.length>0)for(e=0;e<u.length;e++)h=$(c).attr("data-"+u[e]+"-msg"),f(r,h,s);else f(r,null,s)})}function o(n){$(n).find("div[data-valmsg-summary=true]").empty();i($(n).find("div[data-valmsg-summary=true]"),"summary-validation-valid","summary-validation-invalid")}function c(n,t){for(var i,o,s,h,e=0;e<n.length;e++)(i=n[e],o=i.KeyField?$(t.Element).find('[name="'+i.KeyField+'"]'):null,i.KeyFieldMessages&&i.KeyFieldMessages.length!=0)&&((o==null||$(o).length==0)&&i.KeyFieldMessages&&i.KeyFieldMessages.length>0||(n[e].IsFound=!0,s=$(t.Element).find("[data-for="+i.KeyField+"]"),h=$(s).parent(),u[r][t.Name][i.KeyField].$setValidity("custom",!1),f(s,i.KeyFieldMessages[0],h)))}function l(n){var t=$("#"+$(e).attr("validation-summary-id")),r,u;if(t&&t.length!=0&&n&&n.length!=0){for(t.empty(),r=0;r<n.length;r++)u="<div>"+n[r]+"<\/div>",$(t).append(u);i(t,"summary-validation-invalid","summary-validation-valid")}}var r,e,t=[],u={};n.initialise=function(n,i,f){e=n;t=i;u=f;r=$(n).attr("name")};n.resetControl=function(n){var t=$(n).closest("ng-form").attr("name"),i=u[r][t][$(n).attr("name")];u[r][t][$(n).attr("name")].$setValidity("custom",!0);s(i,$(n))};n.validateTabs=function(){for(var n=0;n<t.length;n++)o(t[n].Element),h(t[n])};n.displayServerErrors=function(n){for(var i=0;i<t.length;i++)o(t[i].Element),c(n,t[i]);for(i=0;i<n.length;i++)n[i].IsFound||l(n[i].KeyFieldMessages)};n.clearServerErrors=function(){var n=$("#"+$(e).attr("validation-summary-id"));n&&n.length!=0&&i(n,"summary-validation-valid","summary-validation-invalid")}}(app.TabFormValidator={});app=app||{},function(n){function t(n){return n.split("/")[2].split(" ")[0]}function i(n){return n.split("/")[1]-1}function r(n){return n.split("/")[0]}function u(n){return n.split("/").length>2&&n.split("/")[2].split(" ").length>1?n.split("/")[2].split(" ")[1].split(":")[0]:"0"}function f(n){return n.split("/").length>2&&n.split("/")[2].split(" ").length>1?n.split("/")[2].split(" ")[1].split(":")[1]:"0"}function e(n){return n.split("/").length>2&&n.split("/")[2].split(" ").length>1?n.split("/")[2].split(" ")[1].split(":")[2]:"0"}n.setNonCachedImageFileName=function(n){var t=new Date,i=t.getHours(),r=t.getMinutes(),u=t.getSeconds();return n+"?imagedate="+i+":"+r+":"+u};n.indexOf=function(n,t,i){var o=-1,r,u,e,f;if(!n)return o;for(r=0;r<n.length;r++){if(u=n[r],i)for(e=i.split("."),f=0;f<e.length;f++)u=u[e[f]];if(u==t)return r}return o};n.clearArray=function(n){var i,t;if(n&&n.length)for(i=n.length,t=0;t<i;t++)n.pop()};n.calculateAmountExclVat=function(n,t){if(!n||!t||isNaN(n)||isNaN(t))return 0;var r=parseFloat(t).round(2)/100,i=parseFloat(n).round(2);return parseFloat(i-r*i).round(2)};n.calculateAmountInclVat=function(n,t){if(!n||!t||isNaN(n)||isNaN(t))return 0;var r=parseFloat(t).round(2)/100,i=parseFloat(n).round(2);return parseFloat(r*i+i).round(2)};n.calculateAmountInclVat=function(n,t){if(!n||!t||isNaN(n)||isNaN(t))return 0;var r=parseFloat(t).round(2)/100,i=parseFloat(n).round(2);return parseFloat(r*i+i).round(2)};n.isDateLesser=function(n,o){if(n==""||o=="")return!0;var s=new Date(t(o),i(o),r(o),u(o),f(o),e(o)),h=new Date(t(n),i(n),r(n),u(n),f(n),e(n));return h<s};n.isDateLesserOrEqual=function(n,o){if(n==""||o=="")return!0;var s=new Date(t(o),i(o),r(o),u(o),f(o),e(o)),h=new Date(t(n),i(n),r(n),u(n),f(n),e(n));return h<=s};n.isDateGreaterThanToday=function(n){if(n=="")return!0;var o=new Date,s=new Date(t(n),i(n),r(n),u(n),f(n),e(n));return o.setHours(0,0,0,0),s>=o};n.isDateLesserThanToday=function(n){if(n=="")return!0;var o=new Date,s=new Date(t(n),i(n),r(n),u(n),f(n),e(n));return s<=o};n.createYearRange=function(){var r=new Date,i=r.getFullYear(),t=[],n;for(t.push(i),n=1;n<10;n++)t.push(i-n);return t};Number.prototype.round=function(n){return+(Math.round(this+"e+"+n)+"e-"+n)};n.stringToDate=function(n){return n?n instanceof Date?n:new Date(t(n),i(n),r(n)):""}}(app.Utils={});app=app||{},function(n){n.initialise=function(n){n.state("landing",{url:"/",templateUrl:"app/components/landing/landingView.html",controller:"appController",sessionState:{skip:!0}}).state("aboutus",{url:"/aboutus",templateUrl:"app/components/aboutus/aboutUsView.html",controller:"appController",sessionState:{skip:!0}}).state("contactus",{url:"/contactus",templateUrl:"app/components/contactus/contactUsView.html",controller:"contactUsController",sessionState:{skip:!0}}).state("searchsalons",{url:"/searchsalons",templateUrl:"app/components/searchsalons/searchSalonsView.html",controller:"searchSalonsController",sessionState:{skip:!0}}).state("searchsalon",{url:"/searchsalon/:salonId",templateUrl:"app/components/searchsalon/searchSalonView.html",controller:"searchSalonController",sessionState:{skip:!0}}).state("searchsalondirections",{url:"/searchsalondirections/:salonId",templateUrl:"app/components/searchsalondirections/searchSalonDirectionsView.html",controller:"searchSalonDirectionsController",sessionState:{skip:!0}}).state("login",{url:"/login",templateUrl:"app/components/login/loginView.html",controller:"loginController",sessionState:{skip:!0}}).state("forgotpassword",{url:"/forgotpassword",templateUrl:"app/components/forgotpassword/forgotPasswordView.html",controller:"forgotPasswordController",sessionState:{skip:!0,home:"login"}}).state("register",{url:"/register",templateUrl:"app/components/register/registerView.html",controller:"registerController",sessionState:{skip:!0,home:"login"}}).state("resetpassword",{url:"/resetpassword",templateUrl:"app/components/forgotpassword/resetPasswordView.html",controller:"resetPasswordController",sessionState:{skip:!0,home:"login"}}).state("changepassword",{url:"/changepassword",templateUrl:"app/components/changepassword/changePasswordView.html",controller:"changePasswordController",sessionState:{skip:!0,home:"login"}}).state("home",{url:"/home",templateUrl:"app/components/home/views/homeView.html",controller:"homeController",sessionState:{modules:["Home"],moduleOrder:1}}).state("salons",{url:"/salons",templateUrl:"app/components/salons/salonsView.html",controller:"salonsController",sessionState:{home:"home",moduleOrder:2,modules:["Companies"]}}).state("products",{url:"/products/:salonId",templateUrl:"app/components/products/productsView.html",controller:"productsController",sessionState:{home:"home",moduleOrder:3,modules:["Products"]}}).state("promotionproducts",{url:"/promotionproducts/:productId",templateUrl:"app/components/promotionproducts/promotionProductsView.html",controller:"promotionProductsController",sessionState:{home:"home",moduleOrder:4,modules:["PromotionProducts"]}}).state("companyusers",{url:"/companyusers/:companyId",templateUrl:"app/components/companyusers/companyUsersView.html",controller:"companyUsersController",sessionState:{home:"home",moduleOrder:3,modules:["CompanyUsers"]}}).state("beautytips",{url:"/beautytips",templateUrl:"app/components/beautytips/beautyTipsView.html",controller:"beautyTipsController",sessionState:{home:"home"}}).state("servicesadmin",{url:"/servicesadmin",templateUrl:"app/components/subcategory/subCategoryView.html",controller:"subCategoryController",sessionState:{home:"home"}}).state("salonrequests",{url:"/salonrequests",templateUrl:"app/components/companyrequests/companyRequestsView.html",controller:"companyRequestsController",sessionState:{home:"home",moduleOrder:3,modules:["CompanyRequests"]}}).state("specials",{url:"/specials",templateUrl:"app/components/searchpromotionproducts/searchPromotionProductsView.html",controller:"searchPromotionProductsController",sessionState:{home:"home"}}).state("searchbeautytips",{url:"/searchbeautytips",templateUrl:"app/components/searchbeautytips/searchBeautyTipsView.html",controller:"searchBeautyTipsController",sessionState:{home:"home"}})};n.getLandingRoute=function(n,t){var u=_.sortBy(t,function(n){return!n.sessionState||!n.sessionState.moduleOrder?1e3:n.sessionState.moduleOrder}),i=null,r=null;return _.find(u,function(t){return i=_.find(n,function(n){return!t.sessionState||!t.sessionState.modules?!1:_.indexOf(t.sessionState.modules,n.ModuleName)>=0}),i!=null&&(r=t),i!=null}),r};n.canRouteAccessModule=function(n,t){if(!n||n.length==0||!t.sessionState||!t.sessionState.modules)return!0;var i=_.find(n,function(n){return _.indexOf(t.sessionState.modules,n.ModuleName)>=0});return i!==null&&i!==undefined};n.canModuleAccessRoute=function(n,t){if(!n||n.length==0||!t)return!0;var i=_.find(n,function(n){return n.ModuleName.toLowerCase()==t.toLowerCase()});return i!==null&&i!==undefined};n.getMenuItems=function(t,i,r){for(var o,e=[],f=_.keys(i),u=0;u<f.length;u++)(o=_.find(i[f[u]].MenuItems,function(n){return n.path==r}),o)&&_.each(i[f[u]].MenuItems,function(i){n.canModuleAccessRoute(t,i.module)&&e.push(i)});return e}}(app.RoutesManager={}),function(){"use strict";angular.module("app",["ui.router","ngSanitize","ngCookies","ngResource","angularFileUpload","ui.bootstrap","ncy-angular-breadcrumb","toastr","geolocation","uiGmapgoogle-maps"])}(),function(){"use strict";function n(n,i,r){r.interceptors.push("appHttpInterceptorFactory");r.defaults.useXDomain=!0;t(n,i)}function t(n,t){t.otherwise("/");app.RoutesManager.initialise(n)}angular.module("app").config(n);n.$inject=["$stateProvider","$urlRouterProvider","$httpProvider","$compileProvider"]}(),function(){"use strict";angular.module("app").run(["appFactory","$rootScope",function(n,t){n.Initialise();t.$on("$stateChangeStart",function(i,r,u,f){n.ManageUrlRedirects(i,f,r);t.$broadcast("state-changed",r)});t.$on("$stateChangeSuccess",function(n,i){t.$broadcast("state-menu-changed",i)})}])}();menus={Company:{MenuItems:[{DisplayName:"Company",path:"company",module:"Company",QueryParameters:["companyId"]},{DisplayName:"Employees",path:"employees",module:"Employees",QueryParameters:["companyId"]},{DisplayName:"Users",path:"companyusers",module:"Company",QueryParameters:["companyId"]}]},Organisation:{MenuItems:[{DisplayName:"Organisation",path:"organisation",module:"Organisation",QueryParameters:["organisationId"]},{DisplayName:"Users",path:"organisationusers",module:"Organisation Users",QueryParameters:["organisationId"]}]},SarsConfigurations:{MenuItems:[{DisplayName:"Tax Tables",module:"Tax Tables",path:"taxtables"},{DisplayName:"Allowances",module:"Allowances",path:"allowances"},{DisplayName:"Pension Rules",module:"Pension Rules",path:"pensionrules"},{DisplayName:"RAF Rules",module:"RAF Rules",path:"rafrules"},{DisplayName:"Medical Aid Credits",module:"Medical Aid Credits",path:"medicalaidcredits"}]}};anonymousStates={login:!0,forgotpassword:!0,resetpassword:!0,changepassword:!0,landing:!0,aboutus:!0,contactus:!0,searchsalons:!0,searchsalon:!0,searchsalondirections:!0,register:!0,specials:!0,searchbeautytips:!0};angular.module("app").constant("ServerBaseUrl","http://localhost:64707/");angular.module("app").constant("ServerApiBaseUrl","http://localhost:64707/api/");angular.module("app").constant("SubMenuItems",menus);angular.module("app").constant("AnonymousStates",anonymousStates),function(){"use strict";function n(n,t,i,r,u,f,e,o,s,h){function l(n){n.preventDefault();i.go("userprofile",{userProfileId:u.User.Id})}function a(n){n.preventDefault();i.go("changepassword")}function v(){i.go("organisation",{organisationId:u.User.OrganisationId})}function y(n){n.preventDefault();i.go("login")}function p(n){if(h.SearchText=n,h.SubCategoryId=c.SubCategoryId,i.current.name!="searchsalons")return i.go("searchsalons");i.go(i.current,null,{reload:!0})}function w(n,t){if(t.preventDefault(),h.SearchText=c.SearchText,h.SubCategoryId=n,i.current.name!="searchsalons")return i.go("searchsalons");i.go(i.current,null,{reload:!0})}function b(n){var u={},t;if(c.currentNavItem=n.DisplayName,n.QueryParameters&&n.QueryParameters.length>0)for(t=0;t<n.QueryParameters.length>0;t++)u[n.QueryParameters[t]]=r[n.QueryParameters[t]];i.go(n.path,u)}function k(n){n.preventDefault();i.current.sessionState&&i.current.sessionState.home&&i.go(i.current.sessionState.home)}function d(){}function g(){s.getSubCategories({PageData:{IncludeAllData:!0}}).then(function(n){c.services=n.Items})}var c=n;c.appFactory=u;c.viewProfile=l;c.changePassword=a;c.editOrganisation=v;c.goToMenuItem=b;c.goToHome=k;c.goToLogin=y;c.searchSalons=p;c.subMenuItems=[];c.currentNavItem="";c.SearchText="";c.contactUsModel={};c.send=d;c.services=[];c.serviceSearchSalons=w;g();c.appFactory.Initialise();n.$on("server-error-occurred",function(n,t){t.controller=errorController;f.open(t)});n.$on("state-changed",function(n,t){c.currentNavItem="";c.subMenuItems=!c.appFactory.User||!c.appFactory.User.AccessModules?[]:app.RoutesManager.getMenuItems(c.appFactory.User.AccessModules,e,t.name);c.subMenuItems&&c.subMenuItems.length>0&&(c.currentNavItem=c.subMenuItems[0].DisplayName)})}angular.module("app").controller("appController",n);n.$inject=["$scope","$rootScope","$state","$stateParams","appFactory","notificationFactory","SubMenuItems","AnonymousStates","lookupApiFactory","searchSalonsFactory"]}(),function(){"use strict";function n(n,t){function i(n,i){if(t.Initialise(),t.User&&t.User.AccessModules&&app.RoutesManager.canModuleAccessRoute(t.User.AccessModules,n.module)){$(i).show();return}$(i).hide()}return{restrict:"A",link:i,scope:{module:"@"}}}angular.module("app").directive("accessControl",n);n.$inject=["$state","appFactory"]}(),function(){"use strict";function n(n){function t(t,i,r){var u=r.appGrid?r.appGrid:"appGrid";t.appGrid=app.CustomGrid;t.appGrid.setOptions(t.gridOptions);n.$broadcast("app-grid-rendered",{name:u,grid:t.appGrid})}return{restrict:"A",link:t,scope:{appGrid:"=",gridOptions:"=appGridOptions"}}}angular.module("app").directive("appGrid",n);n.$inject=["$rootScope"]}(),function(){"use strict";function n(){function n(n,t,i){n.$root[i.name]=new app.SubFormValidator;var r=n.$root[i.name];r.initialise(t,n.$root,i.model);t.on("change","select",function(){r.clearValidationMessages()});t.on("blur",'input[type="password"]',function(){r.clearValidationMessages()});t.on("keyup",'input[type="text"]',function(){r.clearValidationMessages()});t.on("blur",'input[type="text"]',function(){r.clearValidationMessages()});t.on("keyup","textarea",function(){r.clearValidationMessages()});t.on("blur","textarea",function(){r.clearValidationMessages()})}return{restrict:"AE",link:n}}angular.module("app").directive("appSubForm",n)}(),function(){"use strict";function n(){function i(n,t,i,r){var u=app.TabFormValidator;u.initialise(t,r.childForms,n);n.$on("server-validation-error-occurred",function(n,t){u.displayServerErrors(t)});n.$on("server-validation-successfull",function(){u.clearServerErrors()});t.bind("submit",function(){u.validateTabs()});t.on("change","select",function(){u.resetControl(this)});t.on("keyup",'input[type="password"]',function(){u.resetControl(this)});t.on("blur",'input[type="password"]',function(){u.resetControl(this)});n.$on("file-uploaded",function(n,t){u.resetControl(t)});t.on("keyup",'input[type="text"]',function(){u.resetControl(this)});t.on("blur",'input[type="text"]',function(){u.resetControl(this)});t.on("keyup","textarea",function(){u.resetControl(this)});t.on("blur","textarea",function(){u.resetControl(this)})}function n(){return{childForms:[]}}var t={restrict:"A",link:i,controller:n};return n.$inject=["$scope"],t}function t(){function n(n,t,i,r){r[0].childForms.push({Element:t,Name:$(t).attr("name")})}return{restrict:"A",link:n,require:["^appTabsValidator"]}}angular.module("app").directive("appTabsValidator",n);angular.module("app").directive("appTabValidator",t)}(),function(){"use strict";function n(){function u(u,o){var h=f(o),s=$(o).attr("name"),c=$("#"+$(o).attr("validation-summary-id"));o.on("change","select",function(){var n=u[s][$(this).attr("name")];t(n,$(this),o);r(o)});o.on("keyup",'input[type="password"]',function(){var n=u[s][$(this).attr("name")];t(n,$(this),o)});o.on("blur",'input[type="password"]',function(){var n=u[s][$(this).attr("name")];t(n,$(this),o);r(o)});o.on("keyup",'input[type="text"]',function(){var n=u[s][$(this).attr("name")];t(n,$(this),o)});o.on("blur",'input[type="text"]',function(){var n=u[s][$(this).attr("name")];t(n,$(this),o);r(o)});o.on("keyup","textarea",function(){var n=u[s][$(this).attr("name")];t(n,$(this),o)});o.on("blur","textarea",function(){var n=u[s][$(this).attr("name")];t(n,$(this),o)});o.bind("submit",function(){var n,f,l;for(r(o),n=0;n<h.length;n++){var e=o.find("[name="+h[n].Name+"]")[0],c=$(e).parent(),t=Object.keys(u[s][h[n].Name].$error);if(t&&t.length>0){for(f=0;f<t.length;f++)l=$(e).attr("data-"+t[f]+"-msg"),i(h[n].Element,l,c);continue}i(h[n].Element,null,c)}});u.$on("server-validation-error-occurred",function(n,t){for(var r,f,u=0;u<t.length;u++)if(r=t[u],f=r.KeyField?$(o).find('[name="'+r.KeyField+'"]'):null,r.KeyFieldMessages&&r.KeyFieldMessages.length!=0){if((f==null||$(f).length==0)&&r.KeyFieldMessages&&r.KeyFieldMessages.length>0){e(o,r.KeyFieldMessages);continue}i($(o).find('div[data-for="'+r.KeyField+'"]')[0],r.KeyFieldMessages[0],$(f).parent())}});u.$on("server-validation-successfull",function(){c&&c.length!=0&&n(c,"summary-validation-valid","summary-validation-invalid")})}function f(n){var t=[];return $(n).find("[data-for]").each(function(n,i){t.push({Element:i,Name:$(i).attr("data-for")})}),t}function i(t,i,r){if(!i){n(t,"k-valid-msg","k-invalid-msg");n(r,null,"haserror");return}n(t,"k-invalid-msg","k-valid-msg");n(r,"haserror",null);$(t).text(i)}function e(t,i){var r=$("#"+$(t).attr("validation-summary-id")),u,f;if(r&&r.length!=0&&i&&i.length!=0){for(r.empty(),u=0;u<i.length;u++)f="<div>"+i[u]+"<\/div>",$(r).append(f);n(r,"summary-validation-invalid","summary-validation-valid")}}function r(t){$(t).find("div[data-valmsg-summary=true]").empty();n($(t).find("div[data-valmsg-summary=true]"),"summary-validation-valid","summary-validation-invalid")}function n(n,t,i){$(n)&&$(n).length>0&&$(n).hasClass(i)&&i&&$(n).removeClass(i);$(n)&&$(n).length>0&&!$(n).hasClass(t)&&t&&$(n).addClass(t)}function t(n,t,r){var s=$(t).attr("name"),f=$(t).parent(),e=$(r).find('div[data-for="'+s+'"]').first(),o,u;if(!n||!n.$invalid){i(e,null,f);return}for(o in n.$error)u=$(t).attr("data-"+o+"-msg"),u&&i(e,u,f)}return{restrict:"EA",link:u}}angular.module("app").directive("appValidator",n)}(),function(){"use strict";function n(){function n(n,t,i){var u=!1,r=$(t).prop("tagName");console.log(r);$(t).on("click",function(){u||(r.toLowerCase()=="input"?$(t).val(i.actionInProgressValue):r.toLowerCase()=="button"&&$(t).text(i.actionInProgressValue),$(t).prop("disabled",!0));u=!1});n.$on("action-complete",function(n,f){u=f?f:!1;r.toLowerCase()=="input"?$(t).val(i.actionValue):r.toLowerCase()=="button"&&$(t).text(i.actionValue);$(t).prop("disabled",!1)})}return{restrict:"A",link:n}}angular.module("app").directive("buttonControl",n)}(),function(){"use strict";function n(){function n(n,t,i,r){r.$parsers.unshift(function(t){var i=n.compareToField;return r.$isEmpty(t)&&r.$isEmpty(i)?r.$setValidity("compare",!0):r.$setValidity("compare",t==i),t});n.$watch("compareToField",function(n){n?r.$setValidity("compare",n==r.$viewValue):r.$setValidity("compare",!0)})}return{require:"ngModel",restrict:"EA",link:n,scope:{compareToField:"=comparefield"}}}angular.module("app").directive("compare",n)}(),function(){"use strict";function i(){function n(n,t,i,r){r.$parsers.push(function(n){return parseInt(n,10)});r.$formatters.push(function(n){return n?""+n:""})}return{restrict:"A",require:"ngModel",link:n}}function n(n){function t(t,i,r,u){u.$parsers.push(function(t){return n.stringToDate(t)});u.$formatters.push(function(t){return t instanceof Date?t:n.stringToDate(t)})}return{restrict:"A",require:"ngModel",link:t}}function t(n){function t(t,i,r){t.$watch(r.fileUploadInput,function(t,r){t!=r&&n.$broadcast("file-uploaded",$(i))})}return{restrict:"A",require:"ngModel",link:t}}angular.module("app").directive("convertToNumber",i);angular.module("app").directive("convertToDate",n);n.$inject=["utilsFactory"];angular.module("app").directive("fileUploadInput",t);t.$inject=["$rootScope"]}(),function(){"use strict";function n(n){function t(t,i){t.$on("state-menu-changed",function(n,t){$(i).find("li.menuitem a").removeClass("current");$(i).find("li[data-url="+t.name+"] a").addClass("current")});i.on("mouseover","li.menuitem",function(){$(i).find("li.menuitem a").removeClass("current");$(this).find("a").addClass("current")});i.on("mouseout","li.menuitem",function(){$(i).find("li.menuitem a").removeClass("current");$(i).find("li[data-url="+n.current.name+"] a").addClass("current")})}return{restrict:"A",link:t}}angular.module("app").directive("menuHighlight",n);n.$inject=["$state","$rootScope"]}(),function(){"use strict";function n(){function n(n,t){function i(n){$(n).parent().children("div.info-container").hasClass("hide")?$(n).parent().children("div.info-container").removeClass("hide").addClass("display"):$(n).parent().children("div.info-container").removeClass("display").addClass("hide")}$(t).click(function(){i(this)})}return{restrict:"EA",link:n}}function t(){function n(n,t){$(t).hide();n.$watch("isLoading",function(n){if(n){var i=$(".content-wrapper"),r=i.position();$(t).css("top",r.top);$(t).show()}else $(t).hide()})}return{restrict:"EA",link:n}}function i(){function n(n,t,i){$(t).find(".navbar-nav-item").click(function(){i.toggleMenuDisplay&&$("#"+i.toggleMenuDisplay).length>0&&$("#"+i.toggleMenuDisplay).collapse("hide")})}return{restrict:"EA",link:n}}angular.module("app").directive("mobileTableToggle",n);angular.module("app").directive("loadingModal",t);angular.module("app").directive("toggleMenuDisplay",i)}();errorController.$inject=["$scope","$uibModalInstance"],function(){"use strict";function n(n,t,i){function r(r){var u=t.defer();return n({method:"POST",url:i+"Account/GetUsers",data:r}).success(function(n){u.resolve({Users:n.Items,TotalUsers:n.TotalItems})}),u.promise}function u(r){var u=t.defer();return n({method:"POST",url:i+"Account/FetchUser/?userId="+r}).success(function(n){u.resolve({User:n.Item})}),u.promise}function f(r){var u=t.defer();return n({method:"POST",url:i+"Account/AddUser",data:r}).success(function(n){u.resolve({User:n.Item})}),u.promise}function e(r){var u=t.defer();return n({method:"POST",url:i+"Account/UpdateUser",data:r}).success(function(n){u.resolve({User:n.Item})}),u.promise}function o(r){var u=t.defer();return n({method:"POST",url:i+"Account/DeleteUser",data:r}).success(function(n){u.resolve({User:n.Item})}),u.promise}return{getUsers:r,getUser:u,addUser:f,updateUser:e,deleteUser:o}}angular.module("app").factory("accountApiFactory",n);n.$inject=["$http","$q","ServerApiBaseUrl"]}(),function(){"use strict";function n(n,t,i,r,u,f){function p(n,t){n&&t&&(localStorage.setItem("TokenKey",t),localStorage.setItem("UserModel",JSON.stringify(n)),h())}function h(){o();c();l();w();a()}function o(){if(localStorage.UserModel===null||localStorage.UserModel===undefined){e.User=null;return}e.User=JSON.parse(localStorage.UserModel);e.User.CreateDate=new Date(e.User.CreateDate)}function c(){if(localStorage.TokenKey===null||localStorage.TokenKey===undefined){e.TokenKey=null;return}e.TokenKey=localStorage.TokenKey}function l(){o();c();e.IsUserLogged=e.User!=null&&e.TokenKey!=null}function w(){if(o(),e.User==null){e.UserDisplayName=null;return}e.UserDisplayName=e.User.FirstName+" "+e.User.LastName}function b(n){if(n===null||n===undefined){sessionStorage.Organisation=null;return}sessionStorage.setItem("Organisation",JSON.stringify(n))}function a(){if(sessionStorage.Organisation===null||sessionStorage.Organisation===undefined){e.Organisation=null;return}e.Organisation=JSON.parse(sessionStorage.Organisation)}function v(r){r&&r.preventDefault;var f=t.defer();return n({method:"Post",url:u+"/Account/LogOut"}).success(function(){localStorage.clear();sessionStorage.clear();e.TokenKey=null;e.Organisation=null;e.Company=null;e.IsUserLogged=!1;e.User=null;e.UserDisplayName=null;i.go("login");f.resolve()}),f.promise}function k(n,t,r){if(l(),f[r.name]||e.IsUserLogged){if(f[r.name]&&e.IsUserLogged&&r.name!=="changepassword"){y();return}f[r.name]&&r.name!=="changepassword"?s(t,r):(!f[r.name],app.RoutesManager.canRouteAccessModule(e.User.AccessModules,r))?s(t,r):(!f[r.name],app.RoutesManager.canRouteAccessModule(e.User.AccessModules,r))?s(t,r):(!f[r.name],app.RoutesManager.canRouteAccessModule(e.User.AccessModules,r))||(n.preventDefault(),errorFactory.handleHttpServerError({status:401,data:{Message:"You do not have enough permessions to access this view."}}))}else{n.preventDefault();v();i.go("login");return}}function s(n,t){if(t.name!="searchsalons",t.name=="login"){y();return}if(!t.sessionState||t.sessionState.skip){sessionStorage.clear();return}if(t.sessionState&&!t.sessionState.organisation){sessionStorage.removeItem("Organisation");return}}function y(){localStorage.clear();sessionStorage.clear();e.TokenKey=null;e.Organisation=null;e.Company=null;e.IsUserLogged=!1;e.User=null;e.UserDisplayName=null}var e={User:null,Organisation:null,Company:null,TokenKey:null,IsUserLogged:!1,UserDisplayName:null,Login:p,LogOut:v,ViewOrganisation:b,SetOrganisation:a,Initialise:h,ManageUrlRedirects:k};return e}angular.module("app").factory("appFactory",n);n.$inject=["$http","$q","$state","$rootScope","ServerApiBaseUrl","AnonymousStates","notificationFactory"]}(),function(){"use strict";function n(n,t,i,r){function u(n){var t=localStorage.getItem("TokenKey");return t&&(n.headers.Authorization="Bearer "+t),n}function f(n){return i.reject(n)}function e(n){var r=s(n);return(t.$broadcast("action-complete"),r&&r.HasErrors)?(t.$broadcast("server-validation-error-occurred",r.ErrorMessages),i.reject(n)):(t.$broadcast("server-validation-successfull",r.ErrorMessages),n)}function o(n){return r.handleHttpServerError(n),t.isLoading=!1,t.$broadcast("action-complete"),i.reject(n)}function s(t){var i=t.data;return n.path()=="/login"&&t.data.UserModel&&(i=JSON.parse(t.data.UserModel)),i}return{request:u,requestError:f,response:e,responseError:o}}angular.module("app").factory("appHttpInterceptorFactory",n);n.$inject=["$location","$rootScope","$q","errorFactory"]}(),function(){"use strict";function n(n,t,i,r,u){function f(t){var r=i.defer();return n({method:"POST",url:u+"/AppRating/AddAppRating",data:t}).success(function(n){r.resolve({AppRating:n.Item})}),r.promise}return{addAppRating:f}}angular.module("app").factory("appRatingApiFactory",n);n.$inject=["$http","$rootScope","$q","$upload","ServerApiBaseUrl"]}(),function(){"use strict";function n(n,t,i,r,u){function f(t){var r=i.defer();return n({method:"POST",url:u+"/BeautyTip/GetBeautyTips",data:t}).success(function(n){r.resolve({BeautyTips:n.Items,TotalBeautyTips:n.TotalItems})}),r.promise}function e(t){var r=i.defer();return n({method:"POST",url:u+"/BeautyTip/FetchBeautyTip/?beautyTipId="+t}).success(function(n){r.resolve({BeautyTip:n.Item})}),r.promise}function o(t){var r=i.defer();return n({method:"POST",url:u+"/BeautyTip/AddBeautyTip",data:t}).success(function(n){r.resolve({BeautyTip:n.Item})}),r.promise}function s(t){var r=i.defer();return n({method:"POST",url:u+"/BeautyTip/UpdateBeautyTip",data:t}).success(function(n){r.resolve({BeautyTip:n.Item})}),r.promise}function h(t){var r=i.defer();return n({method:"POST",url:u+"/BeautyTip/DeleteBeautyTip",data:t}).success(function(n){r.resolve({BeautyTip:n.Item})}),r.promise}function c(t){var r=i.defer();return n({method:"POST",url:u+"/BeautyTip/ActivateBeautyTip",data:t}).success(function(n){r.resolve({BeautyTip:n.Item})}),r.promise}return{getBeautyTips:f,getBeautyTip:e,addBeautyTip:o,updateBeautyTip:s,deleteBeautyTip:h,activateBeautyTip:c}}angular.module("app").factory("beautyTipApiFactory",n);n.$inject=["$http","$rootScope","$q","$upload","ServerApiBaseUrl"]}(),function(){"use strict";function n(n,t,i,r,u){function f(t){var r=i.defer();return n({method:"GET",url:u+"/Company/GetCompanyData/?companyTypeCode="+t}).success(function(n){r.resolve({CompanyData:n})}),r.promise}function e(t){var r=i.defer();return n({method:"POST",url:u+"Company/GetCompanies",data:t}).success(function(n){r.resolve({Companies:n.Items,TotalCompanies:n.TotalItems})}),r.promise}function o(t){var r=i.defer();return n({method:"POST",url:u+"Company/GetAppCompanies",data:t}).success(function(n){r.resolve({Companies:n.Items,TotalCompanies:n.TotalItems})}),r.promise}function s(t){var r=i.defer();return n({method:"POST",url:u+"Company/FetchCompany/?companyId="+t}).success(function(n){r.resolve({Company:n.Item})}),r.promise}function h(t){var r=i.defer();return n({method:"POST",url:u+"Company/AddCompany",data:t}).success(function(n){r.resolve({Company:n.Item})}),r.promise}function c(t){var r=i.defer();return n({method:"POST",url:u+"Company/UpdateCompany",data:t}).success(function(n){r.resolve({Company:n.Item})}),r.promise}function l(t){var r=i.defer();return n({method:"POST",url:u+"Company/DeleteCompany",data:t}).success(function(n){r.resolve({Company:n.Item})}),r.promise}function a(n,t){var f=i.defer();return r.upload({url:u+"Company/SaveImage",method:"POST",file:n}).progress(function(n){t(n)}).success(function(n){f.resolve({CompanyImage:n})}),f.promise}function v(t){var r=i.defer();return n({method:"POST",url:u+"Company/AddCompanyRequest",data:t}).success(function(n){r.resolve({CompanyRequest:n.Item})}),r.promise}function y(t){var r=i.defer();return n({method:"POST",url:u+"Company/UpdateCompanyStatus",data:t}).success(function(){r.resolve()}).error(function(){r.reject()}),r.promise}function p(n,t){var f=i.defer();return r.upload({url:u+"Company/SaveLogo",method:"POST",file:n}).progress(function(n){t(n)}).success(function(n){f.resolve({CompanyImage:n})}),f.promise}return{getCompanies:e,getAppCompanies:o,getCompany:s,addCompany:h,updateCompany:c,deleteCompany:l,saveCompanyImage:a,saveCompanyLogo:p,getCompanyData:f,addCompanyRequest:v,updateCompanyStatus:y}}angular.module("app").factory("companyApiFactory",n);n.$inject=["$http","$rootScope","$q","$upload","ServerApiBaseUrl"]}(),function(){"use strict";function n(n,t,i,r,u){function f(t){var r=i.defer();return n({method:"POST",url:u+"/CompanyRequest/GetCompanyRequests",data:t}).success(function(n){r.resolve({CompanyRequests:n.Items,TotalCompanyRequests:n.TotalItems})}),r.promise}function e(t){var r=i.defer();return n({method:"POST",url:u+"/CompanyRequest/AddCompanyRequest",data:t}).success(function(n){r.resolve({CompanyRequest:n.Item})}),r.promise}function o(t){var r=i.defer();return n({method:"POST",url:u+"/CompanyRequest/UpdateCompanyRequest",data:t}).success(function(n){r.resolve({CompanyRequest:n.Item})}),r.promise}return{getCompanyRequests:f,addCompanyRequest:e,updateCompanyRequest:o}}angular.module("app").factory("companyRequestApiFactory",n);n.$inject=["$http","$rootScope","$q","$upload","ServerApiBaseUrl"]}(),function(){"use strict";function n(n,t,i,r){function u(){var t=i.defer();return n({method:"GET",url:r+"Dashboard/GetData"}).success(function(n){t.resolve({Dashboard:n})}),t.promise}return{getData:u}}angular.module("app").factory("dashboardApiFactory",n);n.$inject=["$http","$rootScope","$q","ServerApiBaseUrl"]}(),function(){"use strict";function n(n){function i(t){var i=t.status,f=n.$new();f.model={ErrorCode:i,ErrorHeader:r(i),ErrorDetails:u(i,t)};n.$broadcast("server-error-occurred",{templateUrl:"errortemplate.html",scope:f,size:"sm"})}function r(n){return n<=0||n>=500?t[0]:t[n]?t[n]:n>=400?t[1]:void 0}function u(n,t){if(n<=0)return"You are not online. Please check your connectivity and try again";if(t.data&&t.data.Message)switch(n){case 405:return t.config.url+" does not support method "+t.config.method;default:return t.data.Message}return t.statusText}var t={0:"Internal Error",1:"Invalid Request",400:"Bad Request",401:"User is not authorized to use this resource",403:"User is forbidden from accessing the resource",405:"Method Not Allowed",407:"Proxy Authentication Required",408:"Request Timeout"};return{handleHttpServerError:i}}angular.module("app").factory("errorFactory",n);n.$inject=["$rootScope"]}(),function(){"use strict";function n(n,t,i){function u(n){return r(n,i+"Lookup/GetCompanTypes")}function f(n){return r(n,i+"Lookup/GetCategories")}function e(n){return r(n,i+"Lookup/GetSubCategories")}function o(r){var u=t.defer();return n({method:"GET",url:i+"Lookup/GetLookupFields?fieldName="+r}).success(function(n){u.resolve(n)}),u.promise}function r(i,r){var u=t.defer();return n({method:"POST",url:r,data:i}).success(function(n){u.resolve(n)}),u.promise}function s(r){var u=t.defer();return n({method:"POST",url:i+"Lookup/SendMessage",data:r}).success(function(n){u.resolve(n)}),u.promise}function h(){var r=t.defer();return n({method:"GET",url:i+"Lookup/GetContactDetails"}).success(function(n){r.resolve(n)}),r.promise}return{getCompanyTypes:u,getCategories:f,getSubCategories:e,sendMessage:s,getContactDetails:h,getLookupFields:o}}angular.module("app").factory("lookupApiFactory",n);n.$inject=["$http","$q","ServerApiBaseUrl"]}(),function(){"use strict";function n(n,t,i){function r(r){var u=t.defer();return n({method:"POST",url:i+"/Module/GetModules/",data:{SearchText:r,PageData:{IncludeAllData:!0,SortOrder:1}}}).success(function(n){u.resolve({Modules:n.Items,TotalModules:n.TotalItems})}),u.promise}return{getAllModules:r}}angular.module("app").factory("moduleApiFactory",n);n.$inject=["$http","$q","ServerApiBaseUrl"]}(),function(){"use strict";function n(n){function t(t){if(t&&t.templateUrl&&t.controller&&t.scope){var r=t.animation?t.animation:!1,i=t.size?t.size:"lg";return n.open({templateUrl:t.templateUrl,controller:t.controller,parent:angular.element(document.body),clickOutsideToClose:!1,fullscreen:!1,backdrop:"static",escapeToClose:!1,scope:t.scope,size:i})}}return{open:t}}angular.module("app").factory("notificationFactory",n);n.$inject=["$uibModal"]}(),function(){"use strict";function n(n,t,i,r){function u(i){var u=t.defer();return n({method:"POST",url:r+"/Organisation/GetOrganisations",data:{SearchText:i,PageData:{IncludeAllData:!0}}}).success(function(n){u.resolve({Organisations:n.Items,TotalOrganisations:n.TotalItems})}),u.promise}function f(i){var u=t.defer();return n({method:"POST",url:r+"/Organisation/FetchOrganisation/?organisationId="+i}).success(function(n){u.resolve({organisation:n.Item})}),u.promise}function e(i){var u=t.defer();return n({method:"POST",url:r+"/Organisation/AddOrganisation",data:i}).success(function(n){u.resolve({organisation:n.Item})}),u.promise}function o(i){var u=t.defer();return n({method:"POST",url:r+"/Organisation/UpdateOrganisation",data:i}).success(function(n){u.resolve({organisation:n.Item})}),u.promise}function s(n,u){var f=t.defer();return i.upload({url:r+"/Organisation/SaveImage",method:"POST",file:n}).progress(function(n){u(n)}).success(function(n){f.resolve({PolicyImage:n})}),f.promise}return{getOrganisations:u,getOrganisation:f,addOrganisation:e,updateOrganisation:o,saveOrganisationLogo:s}}angular.module("app").factory("organisationApiFactory",n);n.$inject=["$http","$q","$upload","ServerApiBaseUrl"]}(),function(){"use strict";function n(n,t,i,r,u){function f(t){var r=i.defer();return n({method:"POST",url:u+"/Product/GetProducts",data:t}).success(function(n){r.resolve({Products:n.Items,TotalProducts:n.TotalItems})}),r.promise}function e(t){var r=i.defer();return n({method:"POST",url:u+"Product/GetAppProducts",data:t}).success(function(n){r.resolve({Products:n.Items,TotalProducts:n.TotalItems})}),r.promise}function o(t){var r=i.defer();return n({method:"POST",url:u+"/Product/FetchProduct/?productId="+t}).success(function(n){r.resolve({Product:n.Item})}),r.promise}function s(t){var r=i.defer();return n({method:"POST",url:u+"/Product/AddProduct",data:t}).success(function(n){r.resolve({Product:n.Item})}),r.promise}function h(t){var r=i.defer();return n({method:"POST",url:u+"/Product/UpdateProduct",data:t}).success(function(n){r.resolve({Product:n.Item})}),r.promise}function c(t){var r=i.defer();return n({method:"POST",url:u+"/Product/DeleteProduct",data:t}).success(function(){r.resolve()}),r.promise}function l(n,t){var f=i.defer();return r.upload({url:u+"/Product/SaveImage",method:"POST",file:n}).progress(function(n){t(n)}).success(function(n){f.resolve({ProductImage:n})}),f.promise}return{getProducts:f,getAppProducts:e,getProduct:o,addProduct:s,updateProduct:h,deleteProduct:c,saveProductLogo:l}}angular.module("app").factory("productApiFactory",n);n.$inject=["$http","$rootScope","$q","$upload","ServerApiBaseUrl"]}(),function(){"use strict";function n(n,t,i,r,u){function f(t){var r=i.defer();return n({method:"POST",url:u+"/PromotionProduct/GetPromotionProducts",data:t}).success(function(n){r.resolve({PromotionProducts:n.Items,TotalPromotionProducts:n.TotalItems})}),r.promise}function e(t){var r=i.defer();return n({method:"POST",url:u+"PromotionProduct/GetAppPromotionProducts",data:t}).success(function(n){r.resolve({PromotionProducts:n.Items,TotalPromotionProducts:n.TotalItems})}),r.promise}function o(t){var r=i.defer();return n({method:"POST",url:u+"/PromotionProduct/FetchPromotionProduct/?promotionProductId="+t}).success(function(n){r.resolve({PromotionProduct:n.Item})}),r.promise}function s(t){var r=i.defer();return n({method:"POST",url:u+"/PromotionProduct/AddPromotionProduct",data:t}).success(function(n){r.resolve({PromotionProduct:n.Item})}),r.promise}function h(t){var r=i.defer();return n({method:"POST",url:u+"/PromotionProduct/UpdatePromotionProduct",data:t}).success(function(n){r.resolve({PromotionProduct:n.Item})}),r.promise}function c(t){var r=i.defer();return n({method:"POST",url:u+"/PromotionProduct/DeletePromotionProduct",data:t}).success(function(){r.resolve()}),r.promise}function l(n,t){var f=i.defer();return r.upload({url:u+"/PromotionProduct/SaveImage",method:"POST",file:n}).progress(function(n){t(n)}).success(function(n){f.resolve({PromotionProductImage:n})}),f.promise}return{getPromotionProducts:f,getAppPromotionProducts:e,getPromotionProduct:o,addPromotionProduct:s,updatePromotionProduct:h,deletePromotionProduct:c,savePromotionProductLogo:l}}angular.module("app").factory("promotionProductApiFactory",n);n.$inject=["$http","$rootScope","$q","$upload","ServerApiBaseUrl"]}(),function(){"use strict";function n(n,t,i){function r(r){var u=t.defer();return n({method:"POST",url:i+"/Role/GetRoles/",data:{SearchText:r,PageData:{IncludeAllData:!0,SortOrder:1}}}).success(function(n){u.resolve({Roles:n.Items,TotalRoles:n.TotalItems})}),u.promise}function u(r){var u=t.defer();return n({method:"POST",url:i+"/Role/GetRoles/",data:r}).success(function(n){u.resolve({Roles:n.Items,TotalRoles:n.TotalItems})}),u.promise}function f(r){var u=t.defer();return n({method:"POST",url:i+"/Role/FetchRole/?roleId="+r}).success(function(n){u.resolve({Role:n.Item})}),u.promise}function e(r){var u=t.defer();return n({method:"POST",url:i+"/Role/AddRole",data:r}).success(function(n){u.resolve({Role:n.Item})}),u.promise}function o(r){var u=t.defer();return n({method:"POST",url:i+"/Role/UpdateRole",data:r}).success(function(n){u.resolve({Role:n.Item})}),u.promise}function s(r){var u=t.defer();return n({method:"POST",url:i+"/Role/DeleteRole",data:r}).success(function(){u.resolve()}),u.promise}return{getAllRoles:r,searchRoles:u,getRole:f,addRole:e,updateRole:o,deleteRole:s}}angular.module("app").factory("roleApiFactory",n);n.$inject=["$http","$q","ServerApiBaseUrl"]}(),function(){"use strict";function n(n,t,i,r,u){function f(t){var r=i.defer();return n({method:"POST",url:u+"/SubCategory/GetSubCategories",data:t}).success(function(n){r.resolve({SubCategories:n.Items,TotalSubCategories:n.TotalItems})}),r.promise}function e(t){var r=i.defer();return n({method:"POST",url:u+"/SubCategory/FetchSubCategory/?subCategoryId="+t}).success(function(n){r.resolve({SubCategory:n.Item})}),r.promise}function o(t){var r=i.defer();return n({method:"POST",url:u+"/SubCategory/AddSubCategory",data:t}).success(function(n){r.resolve({SubCategory:n.Item})}),r.promise}function s(t){var r=i.defer();return n({method:"POST",url:u+"/SubCategory/UpdateSubCategory",data:t}).success(function(n){r.resolve({SubCategory:n.Item})}),r.promise}function h(t){var r=i.defer();return n({method:"POST",url:u+"/SubCategory/DeleteSubCategory",data:t}).success(function(n){r.resolve({SubCategory:n.Item})}),r.promise}return{getSubCategories:f,getSubCategory:e,addSubCategory:o,updateSubCategory:s,deleteSubCategory:h}}angular.module("app").factory("subCategoryApiFactory",n);n.$inject=["$http","$rootScope","$q","$upload","ServerApiBaseUrl"]}(),function(){"use strict";function n(n,t){function i(){var n=t.defer();return navigator.geolocation.getCurrentPosition(function(t){n.resolve({Position:t.coords})},function(){r(n).then(function(t){n.resolve({Position:t.Position})},function(){n.reject({ErrorCode:408,ErrorHeader:"Error retrieving location",ErrorDetails:"Error retrieving location, please ensure that gps location is enabled."})})},{maximumAge:3e3,timeout:1e4,enableHighAccuracy:!0}),n.promise}function r(){var i=t.defer();return n({method:"POST",url:"https://www.googleapis.com/geolocation/v1/geolocate?key=AIzaSyB7Dp0M7lBi97YoSYlpgt_7IDCMeXEZBiQ"}).success(function(n){i.resolve({Position:{latitude:n.location.lat,longitude:n.location.lng}})}),i.promise}function u(n){return n?n instanceof Date?n:new Date(f(n),e(n),o(n)):""}function f(n){return n.split("/")[2].split(" ")[0]}function e(n){var t=n.split("/")[1];return t>0&&(t=t-1),t}function o(n){return n.split("/")[0]}return{stringToDate:u,getCurrentLocation:i}}angular.module("app").factory("utilsFactory",n);n.$inject=["$http","$q"]}(),function(){"use strict";function n(){function n(n){if(isNaN(n))return n;var t=parseFloat(n);return(t*100).toFixed(2)}return n}angular.module("app").filter("percentageFilter",n)}(),function(){"use strict";function n(n,t,i,r,u,f){function s(){e.beautyTipsGrid.SetPage(null,1)}function h(){var n=t.$new();n.actionType="CREATE";e.beautyTipsFactory.beuatyTip={};r.open({templateUrl:"beuatytiptemplate.html",scope:n,size:"lg",controller:beuatyTipModalController})}function c(n){e.beautyTipsFactory.edit(n.Id).then(function(){var n=t.$new();n.actionType="UPDATE";r.open({templateUrl:"beuatytiptemplate.html",scope:n,size:"lg",controller:beuatyTipModalController})})}function l(n){e.beautyTipsFactory.edit(n.Id).then(function(){var n=t.$new();n.actionType="DELETE";r.open({templateUrl:"beuatytiptemplate.html",scope:n,size:"sm",controller:beuatyTipModalController})})}function a(n){e.beautyTipsFactory.beuatyTip=n;e.beautyTipsFactory.actvate(n).then(function(){e.beautyTipsGrid.SetPage(null,1)})}var e=n,o;e.beautyTipsFactory=u;e.addBeuatyTip=h;e.editBeuatyTip=c;e.deleteBeuatyTip=l;e.searchBeuatyTips=s;e.activateBeuatyTip=a;f.Initialise();o=f.User.CompanyId;e.isCompanyUser=f.User.CompanyId!=null;e.SearchFilter={PageData:{Take:30,Skip:0},SearchText:""};e.beautyTipsGridOptions={Paging:{PageIndex:1,PageSize:5},PageSizes:[30,40,60,90,100],Read:function(n){var i=this;t.isLoading=!0;t.loadingMessage="Loading data, please wait ...";e.SearchFilter.PageData.Take=n.take;e.SearchFilter.PageData.Skip=n.skip;e.beautyTipsFactory.searchBeuatyTips(e.SearchFilter).then(function(n){e.beautyTipsGrid.SetDataSource(n.BeautyTips,n.TotalBeautyTips);t.isLoading=!1})}};e.$on("app-grid-rendered",function(){e.beautyTipsFactory.initialise().then(function(){e.beautyTipsGrid.SetPage(null,1)})});e.$on("beuaty-tip-updated",function(){e.beautyTipsGrid.SetPage(null,e.beautyTipsGrid.Paging.PageIndex)})}angular.module("app").controller("beautyTipsController",n);n.$inject=["$scope","$rootScope","$state","notificationFactory","beautyTipsFactory","appFactory"]}(),function(){"use strict";function n(n,t,i,r){function f(){var t=n.defer();return r.getCategories({PageData:{IncludeAllData:!0}}).then(function(n){u.categories=n.Items;t.resolve()}),t.promise}function e(t){var r=n.defer();return i.getBeautyTips(t).then(function(n){r.resolve(n)}),r.promise}function o(t){var r=n.defer();return i.getBeautyTip(t).then(function(n){u.beuatyTip=n.BeautyTip;u.beuatyTip.CategoryId?u.getSubCategories(u.beuatyTip.CategoryId).then(function(){r.resolve()}):r.resolve()}),r.promise}function s(){var t=n.defer();return i.addBeautyTip(u.beuatyTip).then(function(){u.beuatyTip={};t.resolve()}),t.promise}function h(){var t=n.defer();return i.updateBeautyTip(u.beuatyTip).then(function(){u.beuatyTip={};t.resolve()}),t.promise}function c(){var t=n.defer();return i.deleteBeautyTip(u.beuatyTip).then(function(){u.beuatyTip={};t.resolve()}),t.promise}function l(){var t=n.defer();return i.activateBeautyTip(u.beuatyTip).then(function(){u.beuatyTip={};t.resolve()}),t.promise}function a(t){var i=n.defer();return r.getSubCategories({CategoryId:t,PageData:{IncludeAllData:!0}}).then(function(n){u.subCategories=n.Items;i.resolve()}),i.promise}var u={initialise:f,searchBeuatyTips:e,categories:[],subCategories:[],beuatyTip:{},edit:o,add:s,update:h,deleteBeuatyTip:c,getSubCategories:a,actvate:l};return u}angular.module("app").factory("beautyTipsFactory",n);n.$inject=["$q","$rootScope","beautyTipApiFactory","lookupApiFactory"]}();beuatyTipModalController.$inject=["$scope","$rootScope","$uibModalInstance","beautyTipsFactory"],function(){"use strict";function n(n,t,i,r,u,f){function o(){if(!e.frmChangePassword.$valid){t.$broadcast("action-complete",!0);return}u.changePassword(e.model).then(function(n){i.go(n.redirectState)})}var e=n;f.Initialise();e.changepassword=o;e.model={Username:f.User.UserName}}angular.module("app").controller("changePasswordController",n);n.$inject=["$scope","$rootScope","$state","$location","changePasswordFactory","appFactory"]}(),function(){"use strict";function n(n,t,i,r,u){function f(f){var e=t.defer();return n({method:"Post",url:r+"/Account/ChangePassword/",data:f}).success(function(n){if(n.HasErrors){e.reject();return}u.Login(n.Item,n.access_token);var t=app.RoutesManager.getLandingRoute(u.User.AccessModules,i.get());e.resolve({redirectState:t.name})}),e.promise}return{changePassword:f}}angular.module("app").factory("changePasswordFactory",n);n.$inject=["$http","$q","$state","ServerApiBaseUrl","appFactory"]}(),function(){"use strict";function n(n,t,i,r,u,f){function o(){e.requestsGrid.SetPage(null,1)}function s(n){var i=t.$new();i.actionType="CREATE";e.request=n;u.salon={CompanyTypeId:u.companyTypeId,FirstName:n.FirstName,LastName:n.LastName,EmailAddress:n.EmailAddress};r.open({templateUrl:"salontemplate.html",scope:i,size:"lg",controller:salonModalController})}function h(n){t.isLoading=!0;n.StatusCode="DECLINED";f.updateCompanyRequest(n).then(function(){t.isLoading=!1;e.request={};o()})}function c(n){n.preventDefault();i.go("home")}var e=n;e.completeRequest=s;e.declineRequest=h;e.search=o;e.goHome=c;e.request={};e.SearchFilter={PageData:{Take:30,Skip:0},SearchText:""};e.requestsGridOptions={Paging:{PageIndex:1,PageSize:5},PageSizes:[30,40,60,90,100],Read:function(n){var i=this;t.isLoading=!0;t.loadingMessage="Loading data, please wait ...";e.SearchFilter.PageData.Take=n.take;e.SearchFilter.PageData.Skip=n.skip;f.getCompanyRequests(e.SearchFilter).then(function(n){e.requestsGrid.SetDataSource(n.CompanyRequests,n.TotalCompanyRequests);t.isLoading=!1})}};e.$on("app-grid-rendered",function(){u.initialise().then(function(){e.requestsGrid.SetPage(null,1)})});e.$on("salon-updated",function(){t.isLoading=!0;e.request.StatusCode="COMPLETED";f.updateCompanyRequest(request).then(function(){t.isLoading=!1;e.request={};o()})})}angular.module("app").controller("companyRequestsController",n);n.$inject=["$scope","$rootScope","$state","notificationFactory","salonsFactory","companyRequestApiFactory"]}(),function(){"use strict";function n(n,t,i,r,u,f,e){function h(){o.companyUsersGrid.SetPage(null,1)}function c(){var n=t.$new();n.actionType="CREATE";o.companyUsersFactory.user={CompanyId:s,RoleId:o.companyUsersFactory.role.Id};u.open({templateUrl:"companyusertemplate.html",scope:n,size:"xs",controller:companyUserModalController})}function l(n){o.companyUsersFactory.editUser(n.Id).then(function(){var n=t.$new();n.actionType="UPDATE";u.open({templateUrl:"companyusertemplate.html",scope:n,size:"xs",controller:companyUserModalController})})}function a(n){o.companyUsersFactory.editUser(n.Id).then(function(){var i=t.$new();i.actionType="DELETE";i.model=n;u.open({templateUrl:"companyusertemplate.html",scope:i,size:"xs",controller:companyUserModalController})})}function v(n){n.preventDefault();i.go("home")}function y(n){n.preventDefault();i.go("salons")}var o=n,s;e.Initialise();s=r.companyId?r.companyId:e.User.CompanyId;o.companyUsersFactory=f;o.searchCompanyUsers=h;o.addUser=c;o.editUser=l;o.deleteUser=a;o.goHome=v;o.goToSalons=y;o.SearchFilter={PageData:{Take:20,Skip:0},SearchText:"",CompanyId:s};o.companyUsersGridOptions={Paging:{PageIndex:1,PageSize:20},PageSizes:[20,40,60,90,100],Read:function(n){var i=this;t.isLoading=!0;t.loadingMessage="Loading data, please wait ...";o.SearchFilter.PageData.Take=n.take;o.SearchFilter.PageData.Skip=n.skip;o.companyUsersFactory.getUsers(o.SearchFilter).then(function(){o.companyUsersGrid.SetDataSource(o.companyUsersFactory.users,o.companyUsersFactory.totalUsers);t.isLoading=!1})}};o.$on("app-grid-rendered",function(){o.companyUsersFactory.initialise(s).then(function(){o.companyUsersGrid.SetPage(null,1)})});o.$on("user-updated",function(){o.companyUsersGrid.SetPage(null,o.companyUsersGrid.Paging.PageIndex)})}angular.module("app").controller("companyUsersController",n);n.$inject=["$scope","$rootScope","$state","$stateParams","notificationFactory","companyUsersFactory","appFactory"]}(),function(){"use strict";function n(n,t,i,r){function f(i){var f=n.defer(),e={RolesPromise:r.getAllRoles(""),CompanyPrmoise:t.getCompany(i)};return n.all(e).then(function(n){for(var t=0;t<n.RolesPromise.Roles.length;t++)if(n.RolesPromise.Roles[t].Code=="ADM"){u.role=n.RolesPromise.Roles[t];break}u.salon=n.CompanyPrmoise.Company;f.resolve()}),f.promise}function e(t){var r=n.defer();return i.getUsers(t).then(function(n){u.users=n.Users;u.totalUsers=n.TotalUsers;r.resolve()}),r.promise}function o(t){var r=n.defer();return i.getUser(t).then(function(n){u.user=n.User;r.resolve()}),r.promise}function s(){var t=n.defer();return i.addUser(u.user).then(function(){u.user={};t.resolve()}),t.promise}function h(){var t=n.defer();return i.updateUser(u.user).then(function(){u.user={};t.resolve()}),t.promise}function c(){var t=n.defer();return i.deleteUser(u.user).then(function(){u.user={};t.resolve()}),t.promise}var u={initialise:f,salon:{},role:{},getUsers:e,user:{},editUser:o,addUser:s,updateUser:h,deleteUser:c};return u}angular.module("app").factory("companyUsersFactory",n);n.$inject=["$q","companyApiFactory","accountApiFactory","roleApiFactory"]}();companyUserModalController.$inject=["$scope","$rootScope","$uibModalInstance","companyUsersFactory"],function(){"use strict";function n(n,t,i,r){function f(){if(!u.frmContactUs.$valid){t.$broadcast("action-complete",!0);return}r.sendMessage(u.contactUsModel).then(function(){u.isMessageSent=!0})}var u=n;u.isMessageSent=!1;u.model={};u.contactUsModel={};u.sendMessage=f;r.getContactDetails().then(function(n){u.model=n})}angular.module("app").controller("contactUsController",n);n.$inject=["$scope","$rootScope","$state","lookupApiFactory"]}(),function(){"use strict";function n(n,t,i){function u(){}function f(){}function e(){}function o(){i.LogOut()}var r=n;r.viewProfile=u;r.changePassword=f;r.editOrganisation=e;r.logout=o;n.$on("server-error-occurred",function(n,i){i.controller=errorController;t.open(i)})}angular.module("app").controller("headerController",n);n.$inject=["$scope","notificationFactory","appFactory"]}(),function(){"use strict";function n(n,t,i,r){function f(){if(!u.frmForgotPassword.$valid){t.$broadcast("action-complete",!0);return}r.forgotPassword(u.Username).then(function(){u.isPasswordResetSuccessFull=!0})}var u=n;u.isPasswordResetSuccessFull=!1;u.forgotpassword=f}angular.module("app").controller("forgotPasswordController",n);n.$inject=["$scope","$rootScope","$state","forgotPasswordFactory"]}(),function(){"use strict";function n(n,t,i){function r(r){var u=t.defer();return n({method:"Post",url:i+"Account/ForgotPassword/?username="+r}).success(function(n){if(n.HasErrors){u.reject();return}u.resolve()}),u.promise}function u(r){var u=t.defer();return n({method:"Post",url:i+"Account/ResetPassword/",data:r}).success(function(n){if(n.HasErrors){u.reject();return}u.resolve()}),u.promise}return{forgotPassword:r,passwordReset:u}}angular.module("app").factory("forgotPasswordFactory",n);n.$inject=["$http","$q","ServerApiBaseUrl"]}(),function(){"use strict";function n(n,t,i,r,u){function o(){if(!f.frmForgotPassword.$valid){t.$broadcast("action-complete",!0);return}u.passwordReset(f.model).then(function(){f.isPasswordResetSuccessFull=!0})}function s(n){return n.preventDefault(),r.path("/login")}var e=r.search(),f=n;f.isPasswordResetSuccessFull=!1;f.resetpassword=o;f.goToLogin=s;f.model={ForgotPasswordKey:e.key}}angular.module("app").controller("resetPasswordController",n);n.$inject=["$scope","$rootScope","$state","$location","forgotPasswordFactory"]}(),function(){"use strict";function n(n,t,i,r,u){function e(n){n.preventDefault();i.go("salons")}function o(){t.isLoading=!0;t.loadingMessage="Loading data, please wait ...";u.getData().then(function(n){f.model=n.Dashboard;t.isLoading=!1})}function s(n){i.go("products",{salonId:n.Id})}function h(n){i.go("companyusers",{companyId:n.Id})}function c(n){n.preventDefault();i.go("salonrequests")}var f=n;f.model={};f.goToSalons=e;f.goToProducts=s;f.goToUsers=h;f.goToRequests=c;o()}angular.module("app").controller("homeController",n);n.$inject=["$scope","$rootScope","$state","appFactory","dashboardApiFactory"]}(),function(){"use strict";function n(n,t,i,r){function f(){i.path("root.resetpassword")}function e(){if(!u.frmLogin.$valid){t.$broadcast("action-complete",!0);return}r.login(u.model.Username,u.model.Password).then(function(n){i.go(n.redirectState)})}function o(t,i){t.preventDefault();r.loginauthExternalProvider(i,n)}var u=n;u.model={};u.forgotPassword=f;u.login=e;u.externalProviderLogin=o;n.authCompletedCB=function(t){n.$apply(function(){if(t.haslocalaccount=="False")authService.logOut(),authService.externalAuthData={provider:t.provider,userName:t.external_user_name,externalAccessToken:t.external_access_token},$location.path("/associate");else{var i={provider:t.provider,externalAccessToken:t.external_access_token};r.obtainAccessToken(i).then(function(){$location.path("/orders")},function(t){n.message=t.error_description})}})}}angular.module("app").controller("loginController",n);n.$inject=["$scope","$rootScope","$state","loginFactory"]}(),function(){"use strict";function n(n,t,i,r,u,f){function e(e,o){var s=t.defer(),h="grant_type=password&username="+e+"&password="+o;return n({method:"Post",url:r+"Account/Login",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:h}).success(function(n){var t=JSON.parse(n.UserModel),r;if(!t||t.HasErrors){s.reject();return}if(u.Login(t.Item,n.access_token),t.Item.IsFirstTimeLoggedInd){s.resolve({redirectState:"changepassword"});return}if(u.User.AccessModules==null||u.User.AccessModules.length==0){f.handleHttpServerError({status:403,data:{Message:"You do not have enough permessions to access this view."}});s.reject();return}r=app.RoutesManager.getLandingRoute(u.User.AccessModules,i.get());s.resolve({redirectState:r.name})}),s.promise}function o(n,t){var i=location.protocol+"//"+location.host+"/authcomplete.html",u=r+"api/Account/ExternalLogin?provider="+n+"&response_type=token&client_id=ngAuthApp&redirect_uri="+i,f;window.$windowScope=t;f=window.open(u,"Authenticate Account","location=0,status=0,width=600,height=750")}function s(i){var u=t.defer();return n.get(r+"api/account/ObtainLocalAccessToken",{params:{provider:i.provider,externalAccessToken:i.externalAccessToken}}).success(function(n){u.resolve(n)}).error(function(n){u.reject(n)}),u.promise}return{login:e,loginauthExternalProvider:o,obtainAccessToken:s}}angular.module("app").factory("loginFactory",n);n.$inject=["$http","$q","$state","ServerBaseUrl","appFactory","errorFactory"]}(),function(){"use strict";function n(n,t,i,r,u,f){function o(){var n=t.$new();e.organisationsFactory.organisation={};n.actionType="CREATE";r.open({templateUrl:"organisationtemplate.html",scope:n,controller:organisationModalController})}function s(n,t){t.preventDefault();sessionStorage.setItem("Organisation",JSON.stringify(n));i.go("organisation",{organisationId:n.Id})}function h(n,t){t.preventDefault();f.ViewOrganisation(n);i.go("companies")}function c(){e.organisationsFactory.searchOrganisations(e.searchText).then(function(){})}var e=n;e.organisationsFactory=u;e.addOrganisation=o;e.editOrganisation=s;e.viewOrganisation=h;e.searchText="";c()}angular.module("app").controller("organisationsController",n);n.$inject=["$scope","$rootScope","$state","notificationFactory","organisationsFactory","appFactory"]}(),function(){"use strict";function n(n,t){function r(r){var u=n.defer();return t.getOrganisations(r).then(function(n){i.organisations=n.Organisations;i.organisation={};u.resolve()}),u.promise}function u(){i.organisations=data;i.organisation={}}function f(){var r=n.defer();return t.addOrganisation(i.organisation).then(function(n){i.organisations.push(n.organisation);i.organisation={};r.resolve()}),r.promise}function e(r){var u=n.defer();return t.saveOrganisationLogo(r,o).then(function(n){i.organisation.LogoFileName=n.PolicyImage.ImageFileName;i.organisation.LogoFileNamePath=n.PolicyImage.ImageFileNamePath;u.resolve()}),u.promise}function o(n){var t=parseInt(100*n.loaded/n.total);console.log("progress: "+t+"% "+n.config.file.name)}var i={searchOrganisations:r,organisations:[],organisation:{},clearAll:u,add:f,uploadOrganisationImage:e};return i}angular.module("app").factory("organisationsFactory",n);n.$inject=["$q","organisationApiFactory"]}(),function(){"use strict";function n(n,t,i,r,u,f,e,o,s){function l(t){var i=!1;if(n.imageuploading=!0,!t||t.length==0){n.imageuploading=!1;return}if(angular.forEach(t,function(n){if(n.type.indexOf("image")<0){i=!0;return}}),i){alert("Only image files can be uploaded for an organisation logo");n.imageuploading=!1;return}h.organisationFactory.uploadOrganisationImage(t[0]).then(function(){n.imageuploading=!1})}function a(){if(!h.frmOrganisation.$valid){t.$broadcast("action-complete",!0);return}h.organisationFactory.saveOrganisation().then(function(){e.success("Organisation save was successful.","Save")})}function v(){h.postalSameAsPhysicalAddress&&(h.organisationFactory.organisation.PostalAddressLine1=h.organisationFactory.organisation.PhysicalAddressLine1,h.organisationFactory.organisation.PostalAddressLine2=h.organisationFactory.organisation.PhysicalAddressLine2,h.organisationFactory.organisation.PostalAddressSuburb=h.organisationFactory.organisation.PhysicalAddressSuburb,h.organisationFactory.organisation.PostalAddressCity=h.organisationFactory.organisation.PhysicalAddressCity,h.organisationFactory.organisation.PostalAddressPostalCode=h.organisationFactory.organisation.PhysicalAddressPostalCode)}var h=n,c=r.organisationId;s.Initialise();c||(i.$current.self.ncyBreadcrumb.parent="companies",c=s.User.OrganisationId);h.uploadImage=l;h.organisationFactory=f;h.saveOrganisation=a;h.setPostalSameAsPhysicalAddress=v;o.positionClass="toast-bottom-right";h.organisationFactory.getOrganisation(c)}angular.module("app").controller("organisationController",n);n.$inject=["$scope","$rootScope","$state","$stateParams","notificationFactory","organisationFactory","toastr","toastrConfig","appFactory","$breadcrumb"]}(),function(){"use strict";function n(n,t){function r(r){var u=n.defer();return t.getOrganisation(r).then(function(n){i.organisation=n.organisation;u.resolve()}),u.promise}function u(){var r=n.defer();return t.updateOrganisation(i.organisation).then(function(n){i.organisation=n.organisation;r.resolve()}),r.promise}function f(r){var u=n.defer();return t.saveOrganisationLogo(r,e).then(function(n){i.organisation.LogoFileName=n.PolicyImage.ImageFileName;i.organisation.LogoFileNamePath=n.PolicyImage.ImageFileNamePath;u.resolve()}),u.promise}function e(n){var t=parseInt(100*n.loaded/n.total);console.log("progress: "+t+"% "+n.config.file.name)}var i={getOrganisation:r,organisation:{},saveOrganisation:u,uploadOrganisationImage:f};return i}angular.module("app").factory("organisationFactory",n);n.$inject=["$q","organisationApiFactory"]}(),function(){"use strict";function n(n,t,i,r,u,f){function s(){e.organisationUsersGrid.SetPage(null,1)}function h(){var n=t.$new();n.actionType="CREATE";n.roles=e.organisationUserFactory.userRoles;n.model={OrganisationId:o};u.open({templateUrl:"organisationusertemplate.html",scope:n,size:"xs",controller:organisationUserModalController})}function c(n){var i=t.$new();i.actionType="UPDATE";i.roles=e.organisationUserFactory.userRoles;i.model=n;u.open({templateUrl:"organisationusertemplate.html",scope:i,size:"xs",controller:organisationUserModalController})}function l(n){var i=t.$new();i.actionType="DELETE";i.model=n;u.open({templateUrl:"organisationusertemplate.html",scope:i,size:"xs",controller:organisationUserModalController})}var e=n,o=r.organisationId;if(e.organisationUserFactory=f,e.organisationUserFactory.initialise(),!e.organisationUserFactory.organisation||!e.organisationUserFactory.organisation.Id||e.organisationUserFactory.organisation.Id!=Number(o)){i.go("organisations");return}e.searchOrganisationUsers=s;e.addUser=h;e.editUser=c;e.deleteUser=l;e.SearchFilter={PageData:{Take:20,Skip:0},SearchText:"",OrganisationId:o};e.organisationUsersGridOptions={Paging:{PageIndex:1,PageSize:20},PageSizes:[20,40,60,90,100],Read:function(n){var i=this;t.isLoading=!0;t.loadingMessage="Loading data, please wait ...";e.SearchFilter.PageData.Take=n.take;e.SearchFilter.PageData.Skip=n.skip;e.organisationUserFactory.getUsers(e.SearchFilter).then(function(){e.organisationUsersGrid.SetDataSource(e.organisationUserFactory.users,e.organisationUserFactory.totalUsers);t.isLoading=!1})}};e.$on("app-grid-rendered",function(n,t){e.organisationUsersGrid=t.grid;e.organisationUserFactory.getRoles().then(function(){e.organisationUsersGrid.SetPage(null,1)})});e.$on("user-updated",function(){e.organisationUsersGrid.SetPage(null,e.organisationUsersGrid.Paging.PageIndex)})}angular.module("app").controller("organisationUserController",n);n.$inject=["$scope","$rootScope","$state","$stateParams","notificationFactory","organisationUserFactory"]}(),function(){"use strict";function n(n,t,i){function u(){sessionStorage.Organisation!==null&&sessionStorage.Organisation!==undefined&&(r.organisation=JSON.parse(sessionStorage.Organisation))}function f(i){var u=n.defer();return t.getUsers(i).then(function(n){r.users=n.Users;r.totalUsers=n.TotalUsers;u.resolve()}),u.promise}function e(i){var r=n.defer();return t.addUser(i).then(function(){r.resolve()}),r.promise}function o(i){var r=n.defer();return t.updateUser(i).then(function(){r.resolve()}),r.promise}function s(i){var r=n.defer();return t.deleteUser(i).then(function(){r.resolve()}),r.promise}function h(){var t=n.defer();return i.getAllRoles("").then(function(n){r.userRoles=n.Roles;t.resolve()}),t.promise}var r={initialise:u,organisation:{},users:[],totalUsers:0,userRoles:[],getUsers:f,getRoles:h,addUser:e,updateUser:o,deleteUser:s};return r}angular.module("app").factory("organisationUserFactory",n);n.$inject=["$q","accountApiFactory","roleApiFactory"]}();organisationUserModalController.$inject=["$scope","$rootScope","$uibModalInstance","organisationUserFactory"],function(){"use strict";function n(n,t,i,r){function f(){t.close(n.selected.item)}function e(){t.dismiss("cancel")}var u=n;u.items=r;u.selected={item:u.items[0]};u.ok=f;u.cancel=e}angular.module("app").controller("companyController",n);n.$inject=["$scope","$uibModalInstance","$state","items"]}(),function(){"use strict";function n(n,t,i,r,u,f,e){function h(){o.productsGrid.SetPage(null,1)}function c(){var n=t.$new();n.actionType="CREATE";o.productsFactory.product={CompanyId:f.salon.Id};u.open({templateUrl:"producttemplate.html",scope:n,size:"md",controller:productModalController})}function l(n){o.productsFactory.edit(n.Id).then(function(){var n=t.$new();n.actionType="UPDATE";u.open({templateUrl:"producttemplate.html",scope:n,size:"md",controller:productModalController})})}function a(n){o.productsFactory.edit(n.Id).then(function(){var n=t.$new();n.actionType="DELETE";u.open({templateUrl:"producttemplate.html",scope:n,size:"sm",controller:productModalController})})}function v(n){n.preventDefault();i.go("home")}function y(n){n.preventDefault();i.go("salons")}function p(n){i.go("promotionproducts",{productId:n.Id})}var o=n,s;e.Initialise();s=r.salonId?r.salonId:e.User.CompanyId;o.productsFactory=f;o.addProduct=c;o.editProduct=l;o.deleteProduct=a;o.searchProducts=h;o.goHome=v;o.goToSalons=y;o.goToPromotions=p;o.SearchFilter={PageData:{Take:30,Skip:0},SearchText:"",CompanyId:{}};o.productsGridOptions={Paging:{PageIndex:1,PageSize:30},PageSizes:[30,40,60,90,100],Read:function(n){var i=this;t.isLoading=!0;t.loadingMessage="Loading data, please wait ...";o.SearchFilter.PageData.Take=n.take;o.SearchFilter.PageData.Skip=n.skip;o.productsFactory.searchProducts(o.SearchFilter).then(function(n){o.productsGrid.SetDataSource(n.Products,n.TotalProducts);t.isLoading=!1})}};o.$on("app-grid-rendered",function(){o.productsFactory.initialise(s).then(function(){o.SearchFilter.CompanyId=o.productsFactory.salon.Id;o.productsGrid.SetPage(null,1)})});o.$on("product-updated",function(){o.productsGrid.SetPage(null,o.productsGrid.Paging.PageIndex)})}angular.module("app").controller("productsController",n);n.$inject=["$scope","$rootScope","$state","$stateParams","notificationFactory","productsFactory","appFactory"]}(),function(){"use strict";function n(n,t,i,r,u){function e(t){var r=n.defer(),e={companyPromise:i.getCompany(t),categoriesPromise:u.getCategories({PageData:{IncludeAllData:!0}})};return f.product={},n.all(e).then(function(n){f.salon=n.companyPromise.Company;f.categories=n.categoriesPromise.Items;r.resolve()}),r.promise}function o(t){var i=n.defer();return r.getProducts(t).then(function(n){i.resolve({Products:n.Products,TotalProducts:n.TotalProducts})}),i.promise}function s(t){var i=n.defer();return r.getProduct(t).then(function(n){f.product=n.Product;f.product.CategoryId?f.getSubCategories(f.product.CategoryId).then(function(){i.resolve()}):i.resolve()}),i.promise}function h(){var t=n.defer();return r.addProduct(f.product).then(function(){f.product={};t.resolve()}),t.promise}function c(){var t=n.defer();return r.updateProduct(f.product).then(function(){f.product={};t.resolve()}),t.promise}function l(){var t=n.defer();return r.deleteProduct(f.product).then(function(){f.product={};t.resolve()}),t.promise}function a(t){var i=n.defer();return r.saveProductLogo(t,y).then(function(n){f.product.Logo=n.ProductImage.ImageFileName;f.product.RelativeFileName=n.ProductImage.ImageFileNamePath;i.resolve()}),i.promise}function v(t){var i=n.defer();return u.getSubCategories({CategoryId:t,PageData:{IncludeAllData:!0}}).then(function(n){f.subCategories=n.Items;i.resolve()}),i.promise}function y(n){var t=parseInt(100*n.loaded/n.total);console.log("progress: "+t+"% "+n.config.file.name)}var f={initialise:e,searchProducts:o,salon:{},product:{},categories:[],subCategories:[],edit:s,add:h,update:c,deleteProduct:l,getSubCategories:v,uploadLogo:a};return f}angular.module("app").factory("productsFactory",n);n.$inject=["$q","$rootScope","companyApiFactory","productApiFactory","lookupApiFactory"]}();productModalController.$inject=["$scope","$rootScope","$uibModalInstance","productsFactory"],function(){"use strict";function n(n,t,i,r,u,f){function s(){e.promotionProductsGrid.SetPage(null,1)}function h(){var n=t.$new();n.actionType="CREATE";e.promotionProductsFactory.promotionProduct={ProductId:f.product.Id};u.open({templateUrl:"promotionproducttemplate.html",scope:n,size:"lg",controller:promotionProductModalController})}function c(n){e.promotionProductsFactory.edit(n.Id).then(function(){var n=t.$new();n.actionType="UPDATE";u.open({templateUrl:"promotionproducttemplate.html",scope:n,size:"lg",controller:promotionProductModalController})})}function l(n){e.promotionProductsFactory.edit(n.Id).then(function(){var n=t.$new();n.actionType="DELETE";u.open({templateUrl:"promotionproducttemplate.html",scope:n,size:"sm",controller:promotionProductModalController})})}function a(n){n.preventDefault();i.go("home")}function v(n){n.preventDefault();i.go("products",{salonId:e.promotionProductsFactory.product.CompanyId})}function y(n){n.preventDefault();i.go("salons")}var e=n,o=r.productId;e.promotionProductsFactory=f;e.addPromotionProduct=h;e.editPromotionProduct=c;e.deletePromotionProduct=l;e.searchPromotionProducts=s;e.goHome=a;e.goToSalons=y;e.goToProducts=v;e.SearchFilter={PageData:{Take:30,Skip:0},SearchText:"",ProductId:{}};e.promotionProductsGridOptions={Paging:{PageIndex:1,PageSize:5},PageSizes:[30,40,60,90,100],Read:function(n){var i=this;t.isLoading=!0;t.loadingMessage="Loading data, please wait ...";e.SearchFilter.PageData.Take=n.take;e.SearchFilter.PageData.Skip=n.skip;e.promotionProductsFactory.searchPromotionProducts(e.SearchFilter).then(function(n){e.promotionProductsGrid.SetDataSource(n.PromotionProducts,n.TotalPromotionProducts);t.isLoading=!1})}};e.$on("app-grid-rendered",function(){e.promotionProductsFactory.initialise(o).then(function(){e.SearchFilter.ProductId=e.promotionProductsFactory.product.Id;e.promotionProductsGrid.SetPage(null,1)})});e.$on("promotion-product-updated",function(){e.promotionProductsGrid.SetPage(null,e.promotionProductsGrid.Paging.PageIndex)})}angular.module("app").controller("promotionProductsController",n);n.$inject=["$scope","$rootScope","$state","$stateParams","notificationFactory","promotionProductsFactory"]}(),function(){"use strict";function n(n,t,i,r){function f(t){var r=n.defer();return u.product={},u.promotionProduct={},i.getProduct(t).then(function(n){u.product=n.Product;r.resolve()}),r.promise}function e(t){var i=n.defer();return r.getPromotionProducts(t).then(function(n){i.resolve({PromotionProducts:n.PromotionProducts,TotalPromotionProducts:n.TotalPromotionProducts})}),i.promise}function o(t){var i=n.defer();return r.getPromotionProduct(t).then(function(n){u.promotionProduct=n.PromotionProduct;i.resolve()}),i.promise}function s(){var t=n.defer();return r.addPromotionProduct(u.promotionProduct).then(function(){u.promotionProduct={};t.resolve()}),t.promise}function h(){var t=n.defer();return r.updatePromotionProduct(u.promotionProduct).then(function(){u.promotionProductApiFactory={};t.resolve()}),t.promise}function c(){var t=n.defer();return r.deletePromotionProduct(u.promotionProduct).then(function(){u.promotionProduct={};t.resolve()}),t.promise}function l(t){var i=n.defer();return r.savePromotionProductLogo(t,a).then(function(n){u.promotionProduct.Logo=n.PromotionProductImage.ImageFileName;u.promotionProduct.RelativeFileName=n.PromotionProductImage.ImageFileNamePath;i.resolve()}),i.promise}function a(n){var t=parseInt(100*n.loaded/n.total);console.log("progress: "+t+"% "+n.config.file.name)}var u={initialise:f,searchPromotionProducts:e,product:{},promotionProduct:{},edit:o,add:s,update:h,deletePromotionProduct:c,uploadLogo:l};return u}angular.module("app").factory("promotionProductsFactory",n);n.$inject=["$q","$rootScope","productApiFactory","promotionProductApiFactory"]}();promotionProductModalController.$inject=["$scope","$rootScope","$uibModalInstance","promotionProductsFactory"],function(){"use strict";function n(n,t,i,r){function f(){if(!u.frmRegister.$valid){t.$broadcast("action-complete",!0);return}r.register(u.model).then(function(){u.isRegistrationSucceful=!0})}function e(){i.go("landing")}var u=n;u.model={};u.register=f;u.cancel=e;u.isRegistrationSucceful=!1}angular.module("app").controller("registerController",n);n.$inject=["$scope","$rootScope","$state","registerFactory"]}(),function(){"use strict";function n(n,t,i,r){function u(n){var i=t.defer();return r.addCompanyRequest(n).then(function(n){i.resolve(n)}),i.promise}return{register:u}}angular.module("app").factory("registerFactory",n);n.$inject=["$http","$q","$state","companyRequestApiFactory"]}(),function(){"use strict";function n(n,t,i,r,u,f){function o(){e.rolesGrid.SetPage(null,1)}function s(){e.rolesAdminFactory.initialiseRoleModal().then(function(){var n=t.$new();n.actionType="CREATE";u.open({templateUrl:"saveroletemplate.html",scope:n,size:"md",controller:roleAdminSaveModalController})})}function h(n){e.rolesAdminFactory.initialiseRoleModal(n.Id).then(function(){var n=t.$new();n.actionType="UPDATE";u.open({templateUrl:"saveroletemplate.html",scope:n,size:"md",controller:roleAdminSaveModalController})})}function c(n){var i=t.$new();e.rolesAdminFactory.role=n;i.actionType="DELETE";u.open({templateUrl:"saveroletemplate.html",scope:i,size:"md",controller:roleAdminSaveModalController})}var e=n;e.rolesAdminFactory=f;e.searchRoles=o;e.addRole=s;e.editRole=h;e.deleteRole=c;e.SearchFilter={PageData:{Take:20,Skip:0},SearchText:""};e.rolesGridOptions={Paging:{PageIndex:1,PageSize:20},PageSizes:[20,40,60,90,100],Read:function(n){var i=this;t.isLoading=!0;t.loadingMessage="Loading data, please wait ...";e.SearchFilter.PageData.Take=n.take;e.SearchFilter.PageData.Skip=n.skip;e.rolesAdminFactory.getRoles(e.SearchFilter).then(function(){e.rolesGrid.SetDataSource(e.rolesAdminFactory.roles,e.rolesAdminFactory.totalRoles);t.isLoading=!1})}};e.$on("app-grid-rendered",function(n,t){e.rolesGrid=t.grid;e.rolesGrid.SetPage(null,1)});e.$on("roles-updated",function(){e.rolesGrid.SetPage(null,e.rolesGrid.Paging.PageIndex)})}angular.module("app").controller("rolesAdminController",n);n.$inject=["$scope","$rootScope","$state","$stateParams","notificationFactory","rolesAdminFactory"]}(),function(){"use strict";function n(n,t,i){function f(t){var i=n.defer();return l().then(function(){t?r.getRole(t).then(function(){i.resolve()}):i.resolve()}),i.promise}function e(t){var u=n.defer();return i.searchRoles(t).then(function(n){r.roles=n.Roles;r.totalRoles=n.TotalRoles;u.resolve()}),u.promise}function o(t){var u=n.defer();return i.getRole(t).then(function(n){for(var i,t=0;t<r.role.RoleModules.length;t++){if(i=app.Utils.indexOf(n.Role.RoleModules,r.role.RoleModules[t].ModuleId,"ModuleId"),n.Role.RoleModules[i]&&n.Role.RoleModules[i].Id&&i>=0){n.Role.RoleModules[i].IsSelected=!0;continue}n.Role.RoleModules.push(r.role.RoleModules[t])}r.role=n.Role;u.resolve()}),u.promise}function s(){var t=n.defer();return r.role.RoleModules=u(),i.addRole(r.role).then(function(){r.role={};t.resolve()}),t.promise}function h(){var t=n.defer();return r.role.RoleModules=u(),i.updateRole(r.role).then(function(){r.role={};t.resolve()}),t.promise}function c(){var t=n.defer();return r.role.RoleModules=u(),i.deleteRole(r.role).then(function(){r.role={};t.resolve()}),t.promise}function l(){var i=n.defer();return t.getAllModules("").then(function(n){r.role.RoleModules=[];for(var t=0;t<n.Modules.length;t++)r.role.RoleModules.push({ModuleId:n.Modules[t].Id,ModuleName:n.Modules[t].Name,IsSelected:!1});i.resolve()}),i.promise}function u(){for(var t=[],n=0;n<r.role.RoleModules.length;n++)r.role.RoleModules[n].IsSelected&&t.push(r.role.RoleModules[n]);return t}var r={initialiseRoleModal:f,roles:[],role:{},totalRoles:0,getRoles:e,getRole:o,addRole:s,updateRole:h,deleteRole:c};return r}angular.module("app").factory("rolesAdminFactory",n);n.$inject=["$q","moduleApiFactory","roleApiFactory"]}();roleAdminSaveModalController.$inject=["$scope","$rootScope","$uibModalInstance","rolesAdminFactory"],function(){"use strict";function n(n,t){function f(){r(i.companyWorkingHour.DayName);var n=payRollApp.Utils.indexOf(t.CompanyWorkingHours,i.companyWorkingHour.DayName,"DayName");if(n<0){e();return}o(n)}function e(){t.salon.CompanyWorkingHours||(t.salon.CompanyWorkingHours=[]);t.salon.CompanyWorkingHours.push(i.companyWorkingHour);i.companyWorkingHour={ActionType:"CREATE"}}function o(n){t.salon.CompanyWorkingHours[n]=i.companyWorkingHour;i.companyWorkingHour={ActionType:"CREATE"}}function r(n){var t=payRollApp.Utils.indexOf(i.dayNames,n,"FieldValue");t>=0&&(i.dayNames[t].display=!1)}function u(n){var t=payRollApp.Utils.indexOf(i.dayNames,n,"FieldValue");t>=0&&(i.dayNames[t].display=!0)}function s(n){i.companyWorkingHour.ActionType=="UPDATE"&&n.DayName!=i.companyWorkingHour.DayName&&r(i.companyWorkingHour.companyWorkingHour);u(n.DayName);i.companyWorkingHour=n;i.companyWorkingHour.ActionType="UPDATE"}function h(n){var r=payRollApp.Utils.indexOf(i.dayNames,n.DayName,"FieldValue");r<0||(u(n.DayName),t.salon.CompanyWorkingHours.splice(r,1),i.companyWorkingHour={ActionType:"CREATE"})}function c(){i.companyWorkingHour.ActionType=="UPDATE"&&removeAllowanceType(i.companyWorkingHour.DayName);i.companyWorkingHour={ActionType:"CREATE"}}var i={dayNames:angular.copy(t.dayNames),save:f,edit:s,deleteItem:h,reset:c,companyWorkingHour:{ActionType:"CREATE"}};return i}angular.module("app").factory("companyWorkingHourFactory",n);n.$inject=["$rootScope","salonsFactory"]}(),function(){"use strict";function n(n,t,i,r,u){function e(){f.salonsGrid.SetPage(null,1)}function o(){var n=t.$new();n.actionType="CREATE";f.salonsFactory.salon={CompanyTypeId:u.companyTypeId};r.open({templateUrl:"salontemplate.html",scope:n,size:"lg",controller:salonModalController})}function s(n){f.salonsFactory.edit(n.Id).then(function(){var n=t.$new();n.actionType="UPDATE";r.open({templateUrl:"salontemplate.html",scope:n,size:"lg",controller:salonModalController})})}function h(n){f.salonsFactory.edit(n.Id).then(function(){var n=t.$new();n.actionType="DELETE";r.open({templateUrl:"salontemplate.html",scope:n,size:"sm",controller:salonModalController})})}function c(n){n.preventDefault();i.go("home")}function l(n){i.go("products",{salonId:n.Id})}function a(n){i.go("companyusers",{companyId:n.Id})}function v(){f.salonsFactory.selectedSalons&&f.salonsFactory.selectedSalons.length!=0&&(t.isLoading=!0,t.loadingMessage="Activating salons, please wait ...",f.salonsFactory.activateSalons().then(function(){f.salonsGrid.SetPage(null,1)},function(){t.isLoading=!1;var n=t.$new();n.model={ErrorCode:"404",ErrorHeader:"Error Activating Salons",ErrorDetails:"An error occurred while activating salons."};t.$broadcast("server-error-occurred",{templateUrl:"errortemplate.html",scope:n,size:"sm"})}))}function y(){f.salonsFactory.selectedSalons&&f.salonsFactory.selectedSalons.length!=0&&(t.isLoading=!0,t.loadingMessage="Deactivating salons, please wait ...",f.salonsFactory.deactivateSalons().then(function(){f.salonsGrid.SetPage(null,1)},function(){t.isLoading=!1;var n=t.$new();n.model={ErrorCode:"404",ErrorHeader:"Error Activating Salons",ErrorDetails:"An error occurred while activating salons."};t.$broadcast("server-error-occurred",{templateUrl:"errortemplate.html",scope:n,size:"sm"})}))}function p(){f.salonsFactory.selectedSalons&&f.salonsFactory.selectedSalons.length!=0&&(t.isLoading=!0,t.loadingMessage="Deleting salons, please wait ...",f.salonsFactory.deleteSalons().then(function(){f.salonsGrid.SetPage(null,1)},function(){t.isLoading=!1;var n=t.$new();n.model={ErrorCode:"404",ErrorHeader:"Error Deleting Salons",ErrorDetails:"An error occurred while activating salons."};t.$broadcast("server-error-occurred",{templateUrl:"errortemplate.html",scope:n,size:"sm"})}))}var f=n;f.salonsFactory=u;f.addSalon=o;f.editSalon=s;f.deleteSalon=h;f.searchSalons=e;f.goToProducts=l;f.goToUsers=a;f.goHome=c;f.activateSalons=v;f.deactivateSalons=y;f.deleteSalons=p;f.SearchFilter={PageData:{Take:30,Skip:0},SearchText:""};f.salonsGridOptions={Paging:{PageIndex:1,PageSize:5},PageSizes:[30,40,60,90,100],Read:function(n){var i=this;t.isLoading=!0;t.loadingMessage="Loading data, please wait ...";f.SearchFilter.PageData.Take=n.take;f.SearchFilter.PageData.Skip=n.skip;f.salonsFactory.searchSalons(f.SearchFilter).then(function(n){f.salonsGrid.SetDataSource(n.Salons,n.TotalSalons);t.isLoading=!1})}};f.$on("app-grid-rendered",function(){f.salonsFactory.initialise().then(function(){f.salonsGrid.SetPage(null,1)})});f.$on("salon-updated",function(){f.salonsGrid.SetPage(null,f.salonsGrid.Paging.PageIndex)})}angular.module("app").controller("salonsController",n);n.$inject=["$scope","$rootScope","$state","notificationFactory","salonsFactory"]}(),function(){"use strict";function n(n,t,i,r){function o(){var t=n.defer(),i={companyTypesPromise:r.getCompanyTypes({PageData:{IncludeAllData:!0}}),dayNamesPromise:r.getLookupFields("DayName")};return u.selectedSalons=[],n.all(i).then(function(n){u.dayNames=n.dayNamesPromise;for(var i=0;i<n.companyTypesPromise.Items.length;i++)if(n.companyTypesPromise.Items[i].Code=="SALON"){u.companyTypeId=n.companyTypesPromise.Items[i].Id;break}t.resolve()}),t.promise}function s(t){var r=n.defer();return u.selectedSalons=[],i.getCompanies(t).then(function(n){for(var t=0;t<n.Companies.length;t++)n.Companies[t].IsSelected=!1;u.salons=n.Companies;u.salon={};r.resolve({Salons:n.Companies,TotalSalons:n.TotalCompanies})}),r.promise}function h(){u.selectedSalons=[];u.salons=[];u.salon={}}function c(t){var r=n.defer();return i.getCompany(t).then(function(n){u.salon=n.Company;for(var t=0;t<u.salon.Galleries.length;t++)u.salon.Galleries[t].id=t+1;r.resolve()}),r.promise}function l(){var t=n.defer();return i.addCompany(u.salon).then(function(){u.salon={};t.resolve()}),t.promise}function a(){var t=n.defer();return i.updateCompany(u.salon).then(function(){u.salon={};t.resolve()}),t.promise}function v(){var t=n.defer();return i.deleteCompany(u.salon).then(function(){u.salon={};t.resolve()}),t.promise}function y(t){var r=n.defer();return i.saveCompanyLogo(t[0],e).then(function(n){u.salon.Logo={Logo:n.CompanyImage.ImageFileName,ImageType:"Logo",NormalRelativeFileName:n.CompanyImage.ImageFileNamePath,ThumbnailRelativeFileName:n.CompanyImage.ImageFileNamePath,PreviewRelativeFileName:n.CompanyImage.ImageFileNamePath};r.resolve()}),r.promise}function p(t){for(var f=n.defer(),o=[],r=0;r<t.length;r++)o.push(i.saveCompanyImage(t[r],e));return n.all(o).then(function(n){var i,t;for(u.salon.Galleries||(u.salon.Galleries=[]),i=u.salon.Galleries.length+1,t=0;t<n.length;t++)u.salon.Galleries.push({id:i+t,Logo:n[t].CompanyImage.ImageFileName,ImageType:"GALLERY",NormalRelativeFileName:n[t].CompanyImage.ImageFileNamePath,ThumbnailRelativeFileName:n[t].CompanyImage.ImageFileNamePath,PreviewRelativeFileName:n[t].CompanyImage.ImageFileNamePath});f.resolve()}),f.promise}function e(n){var t=parseInt(100*n.loaded/n.total);console.log("progress: "+t+"% "+n.config.file.name)}function w(n,t){for(var r,i=0;i<n.length;i++)r=app.Utils.indexOf(u.selectedSalons,n[i].Id,"Id"),n[i].IsSelected=t,t&&r<0&&u.selectedSalons.push(n[i]),!t&&r>=0&&u.selectedSalons.splice(indexOdSalon,1)}function b(n){var t=app.Utils.indexOf(u.selectedSalons,n.Id,"Id");n.IsSelected&&t<0&&u.selectedSalons.push(n);!n.IsSelected&&t>=0&&u.selectedSalons.splice(indexOdSalon,1)}function k(){if(u.selectedSalons&&u.selectedSalons.length!=0){var t=n.defer(),r={StatusCode:"ACTIVE",Ids:f()};return i.updateCompanyStatus(r).then(function(){u.selectedSalons=[];t.resolve()},function(){t.reject()}),t.promise}}function d(){if(u.selectedSalons&&u.selectedSalons.length!=0){var t=n.defer(),r={StatusCode:"INACTIVE",Ids:f()};return i.updateCompanyStatus(r).then(function(){u.selectedSalons=[];t.resolve()},function(){t.reject()}),t.promise}}function g(){if(u.selectedSalons&&u.selectedSalons.length!=0){var t=n.defer(),r={StatusCode:"DELETED",Ids:f()};return i.updateCompanyStatus(r).then(function(){u.selectedSalons=[];t.resolve()},function(){t.reject()}),t.promise}}function f(){var t=[],n;if(!u.selectedSalons||u.selectedSalons.length==0)return t;for(n=0;n<u.selectedSalons.length;n++)t.push(u.selectedSalons[n].Id);return t}var u={initialise:o,searchSalons:s,salons:[],provinces:[],salon:{},selectedSalons:[],companyTypeId:{},clearAll:h,edit:c,add:l,update:a,deleteSalon:v,uploadSalonImage:p,uploadSalonLogo:y,setSelectedSalon:b,activateSalons:k,deactivateSalons:d,deleteSalons:g,selectAll:w,dayNames:[]};return u}angular.module("app").factory("salonsFactory",n);n.$inject=["$q","$rootScope","companyApiFactory","lookupApiFactory"]}();salonModalController.$inject=["$scope","$rootScope","$uibModalInstance","geolocation","salonsFactory","utilsFactory","companyWorkingHourFactory"],function(){"use strict";function n(n,t,i,r){function f(){u.beautyTipsGrid.SetPage(null,1)}var u=n;u.isLoading=!1;u.searchBeautyTips=f;u.SearchFilter={StatusCode:"ACTIVE",PageData:{Take:30,Skip:0,SortColumn:"CreateDate",SortOrder:2},SearchText:""};u.beautyTipsGridOptions={Paging:{PageIndex:1,PageSize:30},PageSizes:[30,40,60,90,100],Read:function(n){var i=this;t.isLoading=!0;t.loadingMessage="Loading data, please wait ...";u.SearchFilter.PageData.Take=n.take;u.SearchFilter.PageData.Skip=n.skip;r.getBeautyTips(u.SearchFilter).then(function(n){u.beautyTipsGrid.SetDataSource(n.BeautyTips,n.TotalBeautyTips);t.isLoading=!1})}};u.$on("app-grid-rendered",function(n,t){u.beautyTipsGrid=t.grid;u.beautyTipsGrid.SetPage(null,1)})}angular.module("app").controller("searchBeautyTipsController",n);n.$inject=["$scope","$rootScope","$state","beautyTipApiFactory"]}(),function(){"use strict";function n(n,t,i,r,u,f,e){function s(){o.specialsGrid.SetPage(null,1)}function h(n){i.go("searchsalondirections",{salonId:n})}function c(n){var i=t.$new();i.model={ErrorCode:408,ErrorHeader:"Error retrieving location",ErrorDetails:"Error retrieving location, please ensure that gps location is enabled. Error Code: "+n.code+"Error Message: "+n.message};u.open({templateUrl:"errortemplate.html",scope:i,size:"sm",controller:errorController})}var o=n;o.isLoading=!1;o.searchSpecials=s;o.goToSalonDirection=h;o.SearchFilter={PageData:{Take:30,Skip:0},SearchText:""};o.specialsGridOptions={Paging:{PageIndex:1,PageSize:30},PageSizes:[30,40,60,90,100],Read:function(n){var i=this;t.isLoading=!0;t.loadingMessage="Loading data, please wait ...";o.SearchFilter.PageData.Take=n.take;o.SearchFilter.PageData.Skip=n.skip;f.getAppPromotionProducts(o.SearchFilter).then(function(n){o.specialsGrid.SetDataSource(n.PromotionProducts,n.TotalPromotionProducts);t.isLoading=!1})}};o.$on("app-grid-rendered",function(){e.getCurrentLocation().then(function(n){o.SearchFilter.Latitude=n.Position.latitude;o.SearchFilter.Longitude=n.Position.longitude;o.specialsGrid.SetPage(null,1)},c,{maximumAge:3e3,timeout:1e4,enableHighAccuracy:!0})})}angular.module("app").controller("searchPromotionProductsController",n);n.$inject=["$scope","$rootScope","$state","$stateParams","notificationFactory","promotionProductApiFactory","utilsFactory"]}(),function(){"use strict";function n(n,t,i,r,u){function o(){i.go("searchsalondirections",{salonId:f.searchSalonFactory.salon.Id})}var f=n,e=r.salonId;t.isLoading=!0;t.loadingMessage="Loading data, please wait ...";f.goToSalonDirections=o;f.searchSalonFactory=u;f.searchSalonFactory.initialise(e).then(function(){t.isLoading=!1})}angular.module("app").controller("searchSalonController",n);n.$inject=["$scope","$rootScope","$state","$stateParams","searchSalonFactory"]}(),function(){"use strict";function n(n,t,i,r){function f(t){var r=n.defer(),f={companyPromise:i.getCompany(t),productsPromise:e(t)};return n.all(f).then(function(n){u.salon=n.companyPromise.Company;r.resolve()}),r.promise}function e(t){var i=n.defer(),f={PageData:{Take:30,Skip:0},SearchText:"",CompanyId:t,IsCompanySearch:!0};return r.getAppProducts(f).then(function(n){var t=_.groupBy(n.Products,function(n){return n.CategoryName});_.each(_.keys(t),function(n){t[n]=_.groupBy(t[n],function(n){return n.SubCategoryName})});u.products=t;i.resolve()}),i.promise}var u={initialise:f,salon:{},products:[]};return u}angular.module("app").factory("searchSalonFactory",n);n.$inject=["$q","$rootScope","companyApiFactory","productApiFactory"]}(),function(){"use strict";function n(n,t,i,r,u,f,e,o){function c(){var n=t.$new();n.model={ErrorCode:408,ErrorHeader:"Error retrieving location",ErrorDetails:"Error retrieving location, please ensure that gps location is enabled."};e.open({templateUrl:"errortemplate.html",scope:n,size:"sm",controller:errorController})}var s=n,h=r.salonId;s.isLoading=!1;s.salon={};n.map={control:{},center:{latitude:-26.1706755,longitude:28.0483971},zoom:14};o.getCurrentLocation().then(function(t){n.map.center={latitude:t.Position.latitude,longitude:t.Position.longitude};f.getCompany(h).then(function(t){s.salon=t.Company;var i=new google.maps.DirectionsRenderer,u=new google.maps.DirectionsService,e=new google.maps.Geocoder,r={origin:{lat:s.map.center.latitude,lng:s.map.center.longitude},destination:{lat:Number(s.salon.PhysicalAddressLatitude),lng:Number(s.salon.PhysicalAddressLongitude)},showList:!1},f={origin:r.origin,destination:r.destination,travelMode:google.maps.DirectionsTravelMode.DRIVING};u.route(f,function(t,r){r===google.maps.DirectionsStatus.OK?(i.setDirections(t),i.setMap(n.map.control.getGMap()),i.setPanel(document.getElementById("directionsList")),n.showList=!0,s.isLoading=!1):alert("Google route unsuccesfull!")})})},c,{maximumAge:3e3,timeout:1e4,enableHighAccuracy:!0})}angular.module("app").controller("searchSalonDirectionsController",n);n.$inject=["$scope","$rootScope","$state","$stateParams","geolocation","companyApiFactory","notificationFactory","utilsFactory"]}(),function(){"use strict";function n(n,t,i,r,u,f,e,o,s){function c(){h.salonsGrid.SetPage(null,1)}function l(){h.isLoading=!0;t.loadingMessage="Locating current location, please wait ...";s.getCurrentLocation().then(function(n){h.SearchFilter.Latitude=n.Position.latitude;h.SearchFilter.Longitude=n.Position.longitude;h.isLoading=!1;h.salonsGrid.SetPage(null,1)},function(n){var i=t.$new();i.model=n.data;o.open({templateUrl:"errortemplate.html",scope:i,size:"sm",controller:errorController})})}function a(n){i.go("searchsalondirections",{salonId:n.Id})}function v(n){i.go("searchsalon",{salonId:n.Id})}var h=n;h.isLoading=!1;h.searchSalons=c;h.goToSalonDirection=a;h.viewSalon=v;h.salons=[];h.SearchFilter={PageData:{Take:30,Skip:0},SearchText:e.SearchText,SubCategoryId:e.SubCategoryId,IsLocationSearch:!0};e.SearchText="";e.SubCategoryId=null;h.salonsGridOptions={Paging:{PageIndex:1,PageSize:30},PageSizes:[30,40,60,90,100],Read:function(n){var i=this;t.isLoading=!0;t.loadingMessage="Loading data, please wait ...";h.SearchFilter.PageData.Take=n.take;h.SearchFilter.PageData.Skip=n.skip;f.getAppCompanies(h.SearchFilter).then(function(n){h.salonsGrid.SetDataSource(n.Companies,n.TotalCompanies);t.isLoading=!1})}};h.$on("app-grid-rendered",function(){l()})}angular.module("app").controller("searchSalonsController",n);n.$inject=["$scope","$rootScope","$state","$stateParams","geolocation","companyApiFactory","searchSalonsFactory","notificationFactory","utilsFactory"]}(),function(){"use strict";function n(){return{searchFilter:{}}}angular.module("app").factory("searchSalonsFactory",n);n.$inject=["$q","$rootScope","companyApiFactory","lookupApiFactory"]}(),function(){"use strict";function n(n,t,i,r,u){function e(){f.subCategoriesGrid.SetPage(null,1)}function o(){var n=t.$new();n.actionType="CREATE";f.subCategoryFactory.subCategory={};r.open({templateUrl:"subcategorytemplate.html",scope:n,size:"lg",controller:subCategoryModalController})}function s(n){f.subCategoryFactory.edit(n.Id).then(function(){var n=t.$new();n.actionType="UPDATE";r.open({templateUrl:"subcategorytemplate.html",scope:n,size:"lg",controller:subCategoryModalController})})}function h(n){f.subCategoryFactory.edit(n.Id).then(function(){var n=t.$new();n.actionType="DELETE";r.open({templateUrl:"subcategorytemplate.html",scope:n,size:"sm",controller:subCategoryModalController})})}var f=n;f.subCategoryFactory=u;f.addSubCategory=o;f.editSubCategory=s;f.deleteSubCategory=h;f.searchSubCategories=e;f.SearchFilter={PageData:{Take:30,Skip:0},SearchText:"",ShowAll:!0};f.subCategoriesGridOptions={Paging:{PageIndex:1,PageSize:5},PageSizes:[30,40,60,90,100],Read:function(n){var i=this;t.isLoading=!0;t.loadingMessage="Loading data, please wait ...";f.SearchFilter.PageData.Take=n.take;f.SearchFilter.PageData.Skip=n.skip;f.subCategoryFactory.searchSubCategories(f.SearchFilter).then(function(n){f.subCategoriesGrid.SetDataSource(n.SubCategories,n.TotalSubCategories);t.isLoading=!1})}};f.$on("app-grid-rendered",function(){f.subCategoryFactory.initialise().then(function(){f.subCategoriesGrid.SetPage(null,1)})});f.$on("sucategory-updated",function(){f.subCategoriesGrid.SetPage(null,f.subCategoriesGrid.Paging.PageIndex)})}angular.module("app").controller("subCategoryController",n);n.$inject=["$scope","$rootScope","$state","notificationFactory","subCategoryFactory"]}(),function(){"use strict";function n(n,t,i,r){function f(){var t=n.defer();return r.getCategories({PageData:{IncludeAllData:!0}}).then(function(n){u.categories=n.Items;t.resolve()}),t.promise}function e(t){var i=n.defer();return r.getSubCategories(t).then(function(n){i.resolve({SubCategories:n.Items,TotalSubCategories:n.TotalItems})}),i.promise}function o(t){var r=n.defer();return i.getSubCategory(t).then(function(n){u.subCategory=n.SubCategory;r.resolve()}),r.promise}function s(){var t=n.defer();return i.addSubCategory(u.subCategory).then(function(){u.subCategory={};t.resolve()}),t.promise}function h(){var t=n.defer();return i.updateSubCategory(u.subCategory).then(function(){u.subCategory={};t.resolve()}),t.promise}function c(){var t=n.defer();return i.deleteSubCategory(u.subCategory).then(function(){u.beuatyTip={};t.resolve()}),t.promise}var u={initialise:f,searchSubCategories:e,categories:[],subCategory:{},edit:o,add:s,update:h,deleteSubCategory:c};return u}angular.module("app").factory("subCategoryFactory",n);n.$inject=["$q","$rootScope","subCategoryApiFactory","lookupApiFactory"]}();subCategoryModalController.$inject=["$scope","$rootScope","$uibModalInstance","subCategoryFactory"],function(){"use strict";function n(n,t,i,r,u,f,e){function h(){if(!o.frmUserProfile.$valid){t.$broadcast("action-complete",!0);return}o.userProfileFactory.save().then(function(){f.success("User profile save was successful.","Save")})}var o=n,s=r.userProfileId;o.userProfileFactory=u;o.saveProfile=h;e.positionClass="toast-bottom-right";o.userProfileFactory.getUser(s)}angular.module("app").controller("userProfileController",n);n.$inject=["$scope","$rootScope","$state","$stateParams","userProfileFactory","toastr","toastrConfig"]}(),function(){"use strict";function n(n,t){function r(r){var u=n.defer();return t.getUser(r).then(function(n){i.user=n.User;u.resolve()}),u.promise}function u(){var r=n.defer();return t.updateUser(i.user).then(function(n){i.user=n.User;r.resolve()}),r.promise}var i={getUser:r,save:u,user:{}};return i}angular.module("app").factory("userProfileFactory",n);n.$inject=["$q","accountApiFactory"]}();